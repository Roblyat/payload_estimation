#################################################################################################################################################################
### LSTM best-model sweep started: 20260130_183414                                                                                                            ###
### sweep_name=lstm_best_UR3_Load0_5x10^4_under_testHSK_2_20260130_183414                                                                                     ###
### logs_dir=/home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/shared/logs/lstm_best_UR3_Load0_5x10^4_under_testHSK_2_20260130_183414   ###
### dataset=UR3_Load0_5x10^4_under run_tag=testHSK_2                                                                                                          ###
### raw_csv=/workspace/shared/data/raw/UR3_Load0_5x10^4_under.csv                                                                                             ###
### col_format=wide derive_qdd=True                                                                                                                           ###
### test_fraction=0.2 val_fraction=0.1                                                                                                                        ###
### dataset_seeds=[0]                                                                                                                                         ###
### feature_modes=['full']                                                                                                                                    ###
### H_list=[50]                                                                                                                                               ###
### lstm_seeds=[0]                                                                                                                                            ###
### score_lambda=0.5 score_penalty=10.0                                                                                                                       ###
### LSTM: epochs=120 batch=64 units=128 dropout=0.2                                                                                                           ###
### delan_hypers_jsonl=/workspace/shared/evaluation/summary_delan_best_hypers_testHSK_2.jsonl                                                                 ###
### delan_folds_jsonl=/workspace/shared/evaluation/summary_delan_best_folds_testHSK_2.jsonl                                                                   ###
### delan_model_json=/workspace/shared/evaluation/delan_best_model_testHSK_2.json                                                                             ###
### runs_csv=/home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/shared/evaluation/summary_lstm_best_runs_20260130_183414.csv             ###
### runs_jsonl=/home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/shared/evaluation/summary_lstm_best_runs_20260130_183414.jsonl         ###
### configs_csv=/home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/shared/evaluation/summary_lstm_best_configs_20260130_183414.csv       ###
### configs_jsonl=/home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/shared/evaluation/summary_lstm_best_configs_20260130_183414.jsonl   ###
### fh_csv=/home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/shared/evaluation/summary_lstm_best_fh_20260130_183414.csv                 ###
### fh_jsonl=/home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/shared/evaluation/summary_lstm_best_fh_20260130_183414.jsonl             ###
### combined_csv=/home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/shared/evaluation/summary_lstm_best_combined_20260130_183414.csv     ###
### combined_jsonl=/home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/shared/evaluation/summary_lstm_best_combined_20260130_183414.jsonl ###
### best_model_json=/home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/shared/evaluation/lstm_best_model_20260130_183414.json            ###
#################################################################################################################################################################

[OK] d=0 feat=full H=50 score=0.2654 log=/home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/shared/logs/lstm_best_UR3_Load0_5x10^4_under_testHSK_2_20260130_183414/run_lstm_best_d0_20260130_183414.log

#####################################
### Best LSTM combined evaluation ###
#####################################

=================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/combined_evaluation.py --residual_npz /workspace/shared/data/processed/UR3_Load0_5x10^4_under__testHSK_2__K84__residual__delan_jax_struct_s1_ep200_hp_lutter_like_256_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz --model /workspace/shared/models/lstm/best/UR3_Load0_5x10^4_under__testHSK_2__K84__d0__delan_jax_struct_s1_ep200_hp_lutter_like_256_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_lstm.keras --scalers /workspace/shared/models/lstm/best/UR3_Load0_5x10^4_under__testHSK_2__K84__d0__delan_jax_struct_s1_ep200_hp_lutter_like_256_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/scalers_H50.npz --out_dir /workspace/shared/evaluation/lstm_best/UR3_Load0_5x10^4_under__testHSK_2__20260130_183414/best --H 50 --split test --features full --save_pred_npz --K 84 --test_fraction 0.2 --seed 0' ===
=================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-30 17:36:07.792980: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-30 17:36:07.819522: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/workspace/shared/.mplconfig is not a writable directory
Matplotlib created a temporary cache directory at /tmp/matplotlib-2rmrbu7_ because there was an issue with the default path (/workspace/shared/.mplconfig); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
Evaluate & Combine
 residual_npz = /workspace/shared/data/processed/UR3_Load0_5x10^4_under__testHSK_2__K84__residual__delan_jax_struct_s1_ep200_hp_lutter_like_256_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/UR3_Load0_5x10^4_under__testHSK_2__K84__residual__delan_jax_struct_s1_ep200_hp_lutter_like_256_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz
 model        = /workspace/shared/models/lstm/best/UR3_Load0_5x10^4_under__testHSK_2__K84__d0__delan_jax_struct_s1_ep200_hp_lutter_like_256_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_lstm.keras
 split        = test
 H            = 50
 n_traj       = 5
 n_dof        = 6
 feature_dim  = 24
################################################
2026-01-30 17:36:08.831998: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-30 17:36:08.836803: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-30 17:36:08.837607: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-30 17:36:08.839282: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-30 17:36:08.840073: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-30 17:36:08.841270: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-30 17:36:08.917655: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-30 17:36:08.918546: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-30 17:36:08.919289: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-30 17:36:08.920030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9021 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
2026-01-30 17:36:09.227475: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
  done 5/5

################################################
Stage-2 Evaluation (test, valid k>=H-1):
DeLaN torque:   MSE=1.232002e-01  RMSE=3.509988e-01
  per-joint RMSE: 0.2734 0.6768 0.2135 0.1655 0.3370 0.1410
Residual LSTM:  MSE=7.044167e-02      RMSE=2.654085e-01
  per-joint RMSE: 0.1930 0.4987 0.2222 0.1832 0.2131 0.0917
Combined torque MSE=7.044167e-02     RMSE=2.654085e-01
  per-joint RMSE: 0.1930 0.4987 0.2222 0.1832 0.2131 0.0917
################################################

Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_5x10^4_under__testHSK_2__20260130_183414/best/metrics_test_H50.txt
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_5x10^4_under__testHSK_2__20260130_183414/best/metrics_test_H50.json
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_5x10^4_under__testHSK_2__20260130_183414/best/combined_predictions_test_H50.npz
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_5x10^4_under__testHSK_2__20260130_183414/best/residual_gt_vs_pred_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_5x10^4_under__testHSK_2__20260130_183414/best/torque_gt_vs_delan_vs_combined_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_5x10^4_under__testHSK_2__20260130_183414/best/torque_rmse_per_joint_grouped_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_5x10^4_under__testHSK_2__20260130_183414/best/torque_rmse_time_test_H50.png


##########################################
### LSTM best residual plots feat=full ###
##########################################

=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/lstm_best_residual_rmse_aggregate.py --summary_jsonl /workspace/shared/evaluation/summary_lstm_best_runs_20260130_183414.jsonl --out_dir /workspace/shared/evaluation/lstm_best/UR3_Load0_5x10^4_under__testHSK_2__20260130_183414/residual/full --bins 200 --feature full' ===
=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
/workspace/shared/.mplconfig is not a writable directory
Matplotlib created a temporary cache directory at /tmp/matplotlib-10puyevq because there was an issue with the default path (/workspace/shared/.mplconfig); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.


#################################################
### LSTM best combined torque plots feat=full ###
#################################################

===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/lstm_best_combined_torque_rmse_aggregate.py --summary_jsonl /workspace/shared/evaluation/summary_lstm_best_combined_20260130_183414.jsonl --out_dir /workspace/shared/evaluation/lstm_best/UR3_Load0_5x10^4_under__testHSK_2__20260130_183414/combined/full --bins 200 --split test --feature full' ===
===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
/workspace/shared/.mplconfig is not a writable directory
Matplotlib created a temporary cache directory at /tmp/matplotlib-hn5833jx because there was an issue with the default path (/workspace/shared/.mplconfig); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.


##################################
### LSTM best metrics boxplots ###
##################################

=================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/lstm_metrics_boxplots.py --lstm_root /workspace/shared/models/lstm/best --out_dir /workspace/shared/evaluation/lstm_best/UR3_Load0_5x10^4_under__testHSK_2__20260130_183414/boxplots' ===
=================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
/workspace/shared/.mplconfig is not a writable directory
Matplotlib created a temporary cache directory at /tmp/matplotlib-4fmjv_gw because there was an issue with the default path (/workspace/shared/.mplconfig); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
/workspace/evaluation/scripts/lstm_metrics_boxplots.py:186: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  ax1.boxplot([groups[k] for k in top_lbl], labels=top_disp, showmeans=True)
/workspace/evaluation/scripts/lstm_metrics_boxplots.py:193: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  ax2.boxplot([groups[k] for k in bot_lbl], labels=bot_disp, showmeans=True)
/workspace/evaluation/scripts/lstm_metrics_boxplots.py:186: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  ax1.boxplot([groups[k] for k in top_lbl], labels=top_disp, showmeans=True)
/workspace/evaluation/scripts/lstm_metrics_boxplots.py:193: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  ax2.boxplot([groups[k] for k in bot_lbl], labels=bot_disp, showmeans=True)
/workspace/evaluation/scripts/lstm_metrics_boxplots.py:205: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  plt.boxplot(data, labels=disp, showmeans=True)
/workspace/evaluation/scripts/lstm_metrics_boxplots.py:246: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  ax.boxplot(data, labels=disp, showmeans=True)
/workspace/evaluation/scripts/lstm_metrics_boxplots.py:246: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  ax.boxplot(data, labels=disp, showmeans=True)
/workspace/evaluation/scripts/lstm_metrics_boxplots.py:246: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  ax.boxplot(data, labels=disp, showmeans=True)
/workspace/evaluation/scripts/lstm_metrics_boxplots.py:246: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  ax.boxplot(data, labels=disp, showmeans=True)
/workspace/evaluation/scripts/lstm_metrics_boxplots.py:246: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  ax.boxplot(data, labels=disp, showmeans=True)
/workspace/evaluation/scripts/lstm_metrics_boxplots.py:246: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  ax.boxplot(data, labels=disp, showmeans=True)
/workspace/evaluation/scripts/lstm_metrics_boxplots.py:186: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  ax1.boxplot([groups[k] for k in top_lbl], labels=top_disp, showmeans=True)
/workspace/evaluation/scripts/lstm_metrics_boxplots.py:193: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.
  ax2.boxplot([groups[k] for k in bot_lbl], labels=bot_disp, showmeans=True)
[lstm_metrics_boxplots] Saved plots to: /workspace/shared/evaluation/lstm_best/UR3_Load0_5x10^4_under__testHSK_2__20260130_183414/boxplots


#########################################
### LSTM best-model sweep finished OK ###
#########################################
