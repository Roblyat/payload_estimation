################################################################################################################################
### RUN: dataset_seed=1 K=84 test_fraction=0.2 val_fraction=0.1                                                              ###
### npz_in=/workspace/shared/data/preprocessed/delan_UR3_Load0_cc_K84_seed1_dataset/delan_UR3_Load0_cc_K84_seed1_dataset.npz ###
################################################################################################################################

#####################
### 1) PREPROCESS ###
#####################

==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T preprocess bash -lc 'python3 scripts/build_delan_dataset.py --derive_qdd_from_qd True --col_format wide --trajectory_amount 84 --test_fraction 0.2 --val_fraction 0.1 --seed 1 --lowpass_signals True --lowpass_cutoff_hz 10.0 --lowpass_order 4 --lowpass_qdd False --raw_csv /workspace/shared/data/raw/UR3_Load0_cc.csv --out_npz /workspace/shared/data/preprocessed/delan_UR3_Load0_cc_K84_seed1_dataset/delan_UR3_Load0_cc_K84_seed1_dataset.npz' ===
==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Saved: /workspace/shared/data/preprocessed/delan_UR3_Load0_cc_K84_seed1_dataset/delan_UR3_Load0_cc_K84_seed1_dataset.npz
Saved: /workspace/shared/data/preprocessed/delan_UR3_Load0_cc_K84_seed1_dataset/delan_UR3_Load0_cc_K84_seed1_dataset.json
Trajectories: train=59 val=8 test=17
Exists: True


#####################################
### EXPORT RESIDUALS (best DeLaN) ###
#####################################

==========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T delan_jax bash -lc 'python3 /workspace/delan_jax/scripts/export_delan_residuals_jax.py --npz_in /workspace/shared/data/preprocessed/delan_UR3_Load0_cc_K84_seed1_dataset/delan_UR3_Load0_cc_K84_seed1_dataset.npz --ckpt /workspace/shared/models/delan/UR3_Load0_cc__delanModelStory__K84__seed1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__seed1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.jax --out /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz' ===
==========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Loading dataset: /workspace/shared/data/preprocessed/delan_UR3_Load0_cc_K84_seed1_dataset/delan_UR3_Load0_cc_K84_seed1_dataset.npz
Loading checkpoint: /workspace/shared/models/delan/UR3_Load0_cc__delanModelStory__K84__seed1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__seed1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.jax
Detected n_dof=6 (seed=3)
2026-01-29 18:15:01.714173: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.

Exporting split=train: 59 trajectories
  done 25/59
  done 50/59
  done 59/59

Exporting split=test: 17 trajectories
  done 17/17

Saved residual trajectory dataset: /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
Keys: ['test_labels', 'test_q', 'test_qd', 'test_qdd', 'test_r_tau', 'test_t', 'test_tau', 'test_tau_hat', 'train_labels', 'train_q', 'train_qd', 'train_qdd', 'train_r_tau', 'train_t', 'train_tau', 'train_tau_hat']
Saved export JSON: /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.json


##############################
### CONFIG: feat=full H=50 ###
##############################

#########################################
### BUILD LSTM WINDOWS H=50 feat=full ###
#########################################

=========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T preprocess bash -lc 'python3 scripts/build_lstm_windows.py --in_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --out_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --H 50 --features full' ===
=========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Building LSTM windows
  in_npz      = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
  out_npz     = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
  H           = 50
  feature_mode= full
Saved: /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
Saved: /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.json
H=50, n_dof=6, feature_dim=24
X_train: (64507, 50, 24)  Y_train: (64507, 6)
X_test : (14165, 50, 24)  Y_test : (14165, 6)
feature_mode=full


##############################
### TRAIN LSTM seed=0 H=50 ###
##############################

==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T lstm bash -lc 'python3 -c '"'"'import runpy
import keras.callbacks as cb
_Orig = cb.ModelCheckpoint

class PatchedModelCheckpoint(_Orig):
    def __init__(self, filepath, *args, **kwargs):
        if isinstance(filepath, str) and (not filepath.endswith('"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"')) and (not filepath.endswith('"'"'"'"'"'"'"'"'.h5'"'"'"'"'"'"'"'"')):
            filepath = filepath + '"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"'
        super().__init__(filepath, *args, **kwargs)

cb.ModelCheckpoint = PatchedModelCheckpoint
runpy.run_path('"'"'"'"'"'"'"'"'scripts/train_residual_lstm.py'"'"'"'"'"'"'"'"', run_name='"'"'"'"'"'"'"'"'__main__'"'"'"'"'"'"'"'"')
'"'"' --npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --out_dir /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2 --model_name residual_lstm.keras --epochs 120 --batch 64 --val_split 0.1 --seed 0 --units 128 --dropout 0.2 --eps 1e-08 --early_stop True --early_stop_patience 20 --early_stop_min_delta 0.0 --early_stop_warmup_evals 10 ' ===
==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:15:14.027880: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:15:14.053086: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
mkdir -p failed for path /.config/matplotlib: [Errno 13] Permission denied: '/.config'
Matplotlib created a temporary cache directory at /tmp/matplotlib-gyprnib5 because there was an issue with the default path (/.config/matplotlib); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
LSTM Residual Dataset:
  npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
   H  = 50
  din = 24
 dout = 6
  X_train = (64507, 50, 24), Y_train = (64507, 6)
  X_test  = (14165, 50, 24),  Y_test  = (14165, 6)
################################################

Saved scalers: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/scalers_H50.npz
X mean/std shapes: (24,)/(24,)
Y mean/std shapes: (6,)/(6,)
2026-01-29 18:15:15.670906: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:15:15.676117: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:15:15.677055: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:15:15.678697: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:15:15.679507: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:15:15.680392: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:15:15.763993: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:15:15.764962: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:15:15.765761: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:15:15.766541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8574 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
/usr/local/lib/python3.11/dist-packages/keras/src/layers/rnn/rnn.py:205: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 50, 128)        │        78,336 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 50, 128)        │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 128)            │       131,584 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 128)            │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 6)              │           774 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 210,694 (823.02 KB)
 Trainable params: 210,694 (823.02 KB)
 Non-trainable params: 0 (0.00 B)


Epoch 1/120
2026-01-29 18:15:16.909350: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
908/908 - 4s - 4ms/step - loss: 0.0885 - val_loss: 0.1126
Epoch 2/120
908/908 - 3s - 3ms/step - loss: 0.0465 - val_loss: 0.0933
Epoch 3/120
908/908 - 3s - 3ms/step - loss: 0.0394 - val_loss: 0.0879
Epoch 4/120
908/908 - 3s - 3ms/step - loss: 0.0363 - val_loss: 0.0965
Epoch 5/120
908/908 - 3s - 3ms/step - loss: 0.0340 - val_loss: 0.0951
Epoch 6/120
908/908 - 3s - 3ms/step - loss: 0.0327 - val_loss: 0.0915
Epoch 7/120
908/908 - 3s - 3ms/step - loss: 0.0321 - val_loss: 0.0951
Epoch 8/120
908/908 - 3s - 3ms/step - loss: 0.0305 - val_loss: 0.1000
Epoch 9/120
908/908 - 3s - 3ms/step - loss: 0.0302 - val_loss: 0.0969
Epoch 10/120
908/908 - 3s - 3ms/step - loss: 0.0290 - val_loss: 0.0899
Epoch 11/120
908/908 - 3s - 3ms/step - loss: 0.0284 - val_loss: 0.0932
Epoch 12/120
908/908 - 3s - 3ms/step - loss: 0.0279 - val_loss: 0.0905
Epoch 13/120
908/908 - 3s - 3ms/step - loss: 0.0279 - val_loss: 0.0903
Epoch 14/120
908/908 - 3s - 3ms/step - loss: 0.0272 - val_loss: 0.0896
Epoch 15/120
908/908 - 3s - 3ms/step - loss: 0.0266 - val_loss: 0.0887
Epoch 16/120
908/908 - 3s - 3ms/step - loss: 0.0264 - val_loss: 0.0922
Epoch 17/120
908/908 - 3s - 3ms/step - loss: 0.0261 - val_loss: 0.0913
Epoch 18/120
908/908 - 3s - 3ms/step - loss: 0.0257 - val_loss: 0.0853
Epoch 19/120
908/908 - 3s - 3ms/step - loss: 0.0265 - val_loss: 0.0927
Epoch 20/120
908/908 - 3s - 3ms/step - loss: 0.0251 - val_loss: 0.0899
Epoch 21/120
908/908 - 3s - 3ms/step - loss: 0.0250 - val_loss: 0.0907
Epoch 22/120
908/908 - 3s - 3ms/step - loss: 0.0249 - val_loss: 0.0884
Epoch 23/120
908/908 - 3s - 3ms/step - loss: 0.0253 - val_loss: 0.0977
Epoch 24/120
908/908 - 3s - 3ms/step - loss: 0.0249 - val_loss: 0.0907
Epoch 25/120
908/908 - 3s - 3ms/step - loss: 0.0243 - val_loss: 0.0941
Epoch 26/120
908/908 - 3s - 3ms/step - loss: 0.0241 - val_loss: 0.0913
Epoch 27/120
908/908 - 3s - 3ms/step - loss: 0.0238 - val_loss: 0.0943
Epoch 28/120
908/908 - 3s - 3ms/step - loss: 0.0234 - val_loss: 0.0915
Epoch 29/120
908/908 - 3s - 3ms/step - loss: 0.0235 - val_loss: 0.0924
Epoch 30/120
908/908 - 3s - 3ms/step - loss: 0.0233 - val_loss: 0.0903
Epoch 31/120
908/908 - 3s - 3ms/step - loss: 0.0231 - val_loss: 0.0893
Epoch 32/120
908/908 - 3s - 3ms/step - loss: 0.0229 - val_loss: 0.0903
Epoch 33/120
908/908 - 3s - 3ms/step - loss: 0.0228 - val_loss: 0.0913
Epoch 34/120
908/908 - 3s - 3ms/step - loss: 0.0228 - val_loss: 0.0890
Epoch 35/120
908/908 - 3s - 3ms/step - loss: 0.0224 - val_loss: 0.0945
Epoch 36/120
908/908 - 3s - 3ms/step - loss: 0.0223 - val_loss: 0.0934
Epoch 37/120
908/908 - 3s - 3ms/step - loss: 0.0222 - val_loss: 0.0950
Epoch 38/120
908/908 - 3s - 3ms/step - loss: 0.0221 - val_loss: 0.0948
Saved metrics JSON: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/metrics_train_test_H50.json

################################################
LSTM Residual Evaluation (test, unscaled units):
Total RMSE: 0.0896
Per-joint RMSE: 0.1289 0.0969 0.0865 0.0675 0.0787 0.0625
################################################

Saved predictions: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/predictions_test.npz
Saved best model:  /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_lstm.keras
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/loss_curve.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_gt_vs_pred.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_rmse_per_joint.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_rmse_time.png


#################################
### COMBINED EVAL seed=0 H=50 ###
#################################

=========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/combined_evaluation.py --residual_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --model /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_lstm.keras --scalers /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/scalers_H50.npz --out_dir /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2 --H 50 --split test --features full --save_pred_npz --metrics_csv /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv --metrics_json /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl --K 84 --test_fraction 0.2 --seed 0 --dataset_seed 1 --delan_seed 3 --delan_epochs 200 --hp_preset lutter_like_256_d3 --delan_rmse_val 0.3525549655191049 --delan_rmse_test 0.3336736226108652' ===
=========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:16:59.311427: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:16:59.337860: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/workspace/shared/.mplconfig is not a writable directory
Matplotlib created a temporary cache directory at /tmp/matplotlib-o_20twb8 because there was an issue with the default path (/workspace/shared/.mplconfig); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
Evaluate & Combine
 residual_npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
 model        = /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_lstm.keras
 split        = test
 H            = 50
 n_traj       = 17
 n_dof        = 6
 feature_dim  = 24
################################################
2026-01-29 18:17:00.350713: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:00.355792: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:00.356710: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:00.358382: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:00.359248: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:00.359984: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:00.435409: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:00.436243: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:00.436983: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:00.437707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8751 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
2026-01-29 18:17:00.742386: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
  done 17/17

################################################
Stage-2 Evaluation (test, valid k>=H-1):
DeLaN torque:   MSE=1.134792e-01  RMSE=3.368667e-01
  per-joint RMSE: 0.3925 0.4749 0.3226 0.2785 0.2512 0.2379
Residual LSTM:  MSE=8.024953e-03      RMSE=8.958210e-02
  per-joint RMSE: 0.1289 0.0970 0.0865 0.0675 0.0787 0.0625
Combined torque MSE=8.024953e-03     RMSE=8.958210e-02
  per-joint RMSE: 0.1289 0.0970 0.0865 0.0675 0.0787 0.0625
################################################

Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/metrics_test_H50.txt
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/metrics_test_H50.json
Appended CSV: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv
Appended JSON: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/combined_predictions_test_H50.npz
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_gt_vs_pred_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/torque_gt_vs_delan_vs_combined_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/torque_rmse_per_joint_grouped_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H50_ep120_b64_u128_do0p2/torque_rmse_time_test_H50.png


##############################
### TRAIN LSTM seed=1 H=50 ###
##############################

==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T lstm bash -lc 'python3 -c '"'"'import runpy
import keras.callbacks as cb
_Orig = cb.ModelCheckpoint

class PatchedModelCheckpoint(_Orig):
    def __init__(self, filepath, *args, **kwargs):
        if isinstance(filepath, str) and (not filepath.endswith('"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"')) and (not filepath.endswith('"'"'"'"'"'"'"'"'.h5'"'"'"'"'"'"'"'"')):
            filepath = filepath + '"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"'
        super().__init__(filepath, *args, **kwargs)

cb.ModelCheckpoint = PatchedModelCheckpoint
runpy.run_path('"'"'"'"'"'"'"'"'scripts/train_residual_lstm.py'"'"'"'"'"'"'"'"', run_name='"'"'"'"'"'"'"'"'__main__'"'"'"'"'"'"'"'"')
'"'"' --npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --out_dir /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2 --model_name residual_lstm.keras --epochs 120 --batch 64 --val_split 0.1 --seed 1 --units 128 --dropout 0.2 --eps 1e-08 --early_stop True --early_stop_patience 20 --early_stop_min_delta 0.0 --early_stop_warmup_evals 10 ' ===
==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:17:02.934832: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:17:02.960533: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
mkdir -p failed for path /.config/matplotlib: [Errno 13] Permission denied: '/.config'
Matplotlib created a temporary cache directory at /tmp/matplotlib-7caxah5i because there was an issue with the default path (/.config/matplotlib); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
LSTM Residual Dataset:
  npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
   H  = 50
  din = 24
 dout = 6
  X_train = (64507, 50, 24), Y_train = (64507, 6)
  X_test  = (14165, 50, 24),  Y_test  = (14165, 6)
################################################

Saved scalers: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/scalers_H50.npz
X mean/std shapes: (24,)/(24,)
Y mean/std shapes: (6,)/(6,)
2026-01-29 18:17:04.582380: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:04.587515: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:04.588437: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:04.590106: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:04.591021: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:04.591877: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:04.683658: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:04.684555: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:04.685344: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:17:04.686118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8746 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
/usr/local/lib/python3.11/dist-packages/keras/src/layers/rnn/rnn.py:205: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 50, 128)        │        78,336 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 50, 128)        │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 128)            │       131,584 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 128)            │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 6)              │           774 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 210,694 (823.02 KB)
 Trainable params: 210,694 (823.02 KB)
 Non-trainable params: 0 (0.00 B)


Epoch 1/120
2026-01-29 18:17:05.779811: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
908/908 - 4s - 4ms/step - loss: 0.0867 - val_loss: 0.1024
Epoch 2/120
908/908 - 3s - 3ms/step - loss: 0.0459 - val_loss: 0.0988
Epoch 3/120
908/908 - 3s - 3ms/step - loss: 0.0391 - val_loss: 0.0957
Epoch 4/120
908/908 - 3s - 3ms/step - loss: 0.0356 - val_loss: 0.0944
Epoch 5/120
908/908 - 3s - 3ms/step - loss: 0.0337 - val_loss: 0.0921
Epoch 6/120
908/908 - 3s - 3ms/step - loss: 0.0328 - val_loss: 0.0946
Epoch 7/120
908/908 - 3s - 3ms/step - loss: 0.0319 - val_loss: 0.0968
Epoch 8/120
908/908 - 3s - 3ms/step - loss: 0.0305 - val_loss: 0.0930
Epoch 9/120
908/908 - 3s - 3ms/step - loss: 0.0296 - val_loss: 0.0931
Epoch 10/120
908/908 - 3s - 4ms/step - loss: 0.0293 - val_loss: 0.0967
Epoch 11/120
908/908 - 3s - 3ms/step - loss: 0.0283 - val_loss: 0.0904
Epoch 12/120
908/908 - 3s - 3ms/step - loss: 0.0281 - val_loss: 0.0901
Epoch 13/120
908/908 - 3s - 3ms/step - loss: 0.0280 - val_loss: 0.0924
Epoch 14/120
908/908 - 3s - 3ms/step - loss: 0.0271 - val_loss: 0.0912
Epoch 15/120
908/908 - 3s - 3ms/step - loss: 0.0273 - val_loss: 0.0890
Epoch 16/120
908/908 - 3s - 3ms/step - loss: 0.0266 - val_loss: 0.0932
Epoch 17/120
908/908 - 3s - 3ms/step - loss: 0.0262 - val_loss: 0.0919
Epoch 18/120
908/908 - 3s - 3ms/step - loss: 0.0259 - val_loss: 0.0917
Epoch 19/120
908/908 - 3s - 3ms/step - loss: 0.0256 - val_loss: 0.0911
Epoch 20/120
908/908 - 3s - 3ms/step - loss: 0.0254 - val_loss: 0.0873
Epoch 21/120
908/908 - 3s - 3ms/step - loss: 0.0251 - val_loss: 0.0891
Epoch 22/120
908/908 - 3s - 3ms/step - loss: 0.0254 - val_loss: 0.0906
Epoch 23/120
908/908 - 3s - 3ms/step - loss: 0.0246 - val_loss: 0.0922
Epoch 24/120
908/908 - 3s - 3ms/step - loss: 0.0246 - val_loss: 0.0911
Epoch 25/120
908/908 - 3s - 3ms/step - loss: 0.0243 - val_loss: 0.0927
Epoch 26/120
908/908 - 3s - 3ms/step - loss: 0.0241 - val_loss: 0.0954
Epoch 27/120
908/908 - 3s - 3ms/step - loss: 0.0239 - val_loss: 0.0925
Epoch 28/120
908/908 - 3s - 3ms/step - loss: 0.0237 - val_loss: 0.0925
Epoch 29/120
908/908 - 3s - 3ms/step - loss: 0.0236 - val_loss: 0.0951
Epoch 30/120
908/908 - 3s - 3ms/step - loss: 0.0235 - val_loss: 0.0940
Epoch 31/120
908/908 - 3s - 3ms/step - loss: 0.0233 - val_loss: 0.0949
Epoch 32/120
908/908 - 3s - 3ms/step - loss: 0.0230 - val_loss: 0.0911
Epoch 33/120
908/908 - 3s - 3ms/step - loss: 0.0242 - val_loss: 0.1018
Epoch 34/120
908/908 - 3s - 3ms/step - loss: 0.0226 - val_loss: 0.0987
Epoch 35/120
908/908 - 3s - 3ms/step - loss: 0.0225 - val_loss: 0.0950
Epoch 36/120
908/908 - 3s - 3ms/step - loss: 0.0224 - val_loss: 0.1016
Epoch 37/120
908/908 - 3s - 3ms/step - loss: 0.0224 - val_loss: 0.0910
Epoch 38/120
908/908 - 3s - 3ms/step - loss: 0.0222 - val_loss: 0.0927
Epoch 39/120
908/908 - 3s - 3ms/step - loss: 0.0220 - val_loss: 0.0935
Epoch 40/120
908/908 - 3s - 3ms/step - loss: 0.0219 - val_loss: 0.1037
Saved metrics JSON: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/metrics_train_test_H50.json

################################################
LSTM Residual Evaluation (test, unscaled units):
Total RMSE: 0.0877
Per-joint RMSE: 0.1130 0.1029 0.0878 0.0674 0.0828 0.0608
################################################

Saved predictions: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/predictions_test.npz
Saved best model:  /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_lstm.keras
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/loss_curve.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_gt_vs_pred.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_rmse_per_joint.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_rmse_time.png


#################################
### COMBINED EVAL seed=1 H=50 ###
#################################

=========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/combined_evaluation.py --residual_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --model /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_lstm.keras --scalers /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/scalers_H50.npz --out_dir /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2 --H 50 --split test --features full --save_pred_npz --metrics_csv /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv --metrics_json /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl --K 84 --test_fraction 0.2 --seed 1 --dataset_seed 1 --delan_seed 3 --delan_epochs 200 --hp_preset lutter_like_256_d3 --delan_rmse_val 0.3525549655191049 --delan_rmse_test 0.3336736226108652' ===
=========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:18:56.805896: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:18:56.832072: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/workspace/shared/.mplconfig is not a writable directory
Matplotlib created a temporary cache directory at /tmp/matplotlib-7pnsug5i because there was an issue with the default path (/workspace/shared/.mplconfig); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
Evaluate & Combine
 residual_npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
 model        = /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_lstm.keras
 split        = test
 H            = 50
 n_traj       = 17
 n_dof        = 6
 feature_dim  = 24
################################################
2026-01-29 18:18:57.896014: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:18:57.901201: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:18:57.902071: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:18:57.903763: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:18:57.904743: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:18:57.905565: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:18:57.991672: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:18:57.993245: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:18:57.994064: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:18:57.994808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8275 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
2026-01-29 18:18:58.303970: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
  done 17/17

################################################
Stage-2 Evaluation (test, valid k>=H-1):
DeLaN torque:   MSE=1.134792e-01  RMSE=3.368667e-01
  per-joint RMSE: 0.3925 0.4749 0.3226 0.2785 0.2512 0.2379
Residual LSTM:  MSE=7.693703e-03      RMSE=8.771376e-02
  per-joint RMSE: 0.1130 0.1029 0.0878 0.0674 0.0828 0.0608
Combined torque MSE=7.693703e-03     RMSE=8.771376e-02
  per-joint RMSE: 0.1130 0.1029 0.0878 0.0674 0.0828 0.0608
################################################

Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/metrics_test_H50.txt
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/metrics_test_H50.json
Appended CSV: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv
Appended JSON: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/combined_predictions_test_H50.npz
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_gt_vs_pred_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/torque_gt_vs_delan_vs_combined_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/torque_rmse_per_joint_grouped_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H50_ep120_b64_u128_do0p2/torque_rmse_time_test_H50.png


###############################
### CONFIG: feat=full H=100 ###
###############################

##########################################
### BUILD LSTM WINDOWS H=100 feat=full ###
##########################################

===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T preprocess bash -lc 'python3 scripts/build_lstm_windows.py --in_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --out_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --H 100 --features full' ===
===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Building LSTM windows
  in_npz      = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
  out_npz     = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
  H           = 100
  feature_mode= full
Saved: /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
Saved: /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.json
H=100, n_dof=6, feature_dim=24
X_train: (61557, 100, 24)  Y_train: (61557, 6)
X_test : (13315, 100, 24)  Y_test : (13315, 6)
feature_mode=full


###############################
### TRAIN LSTM seed=0 H=100 ###
###############################

================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T lstm bash -lc 'python3 -c '"'"'import runpy
import keras.callbacks as cb
_Orig = cb.ModelCheckpoint

class PatchedModelCheckpoint(_Orig):
    def __init__(self, filepath, *args, **kwargs):
        if isinstance(filepath, str) and (not filepath.endswith('"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"')) and (not filepath.endswith('"'"'"'"'"'"'"'"'.h5'"'"'"'"'"'"'"'"')):
            filepath = filepath + '"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"'
        super().__init__(filepath, *args, **kwargs)

cb.ModelCheckpoint = PatchedModelCheckpoint
runpy.run_path('"'"'"'"'"'"'"'"'scripts/train_residual_lstm.py'"'"'"'"'"'"'"'"', run_name='"'"'"'"'"'"'"'"'__main__'"'"'"'"'"'"'"'"')
'"'"' --npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --out_dir /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2 --model_name residual_lstm.keras --epochs 120 --batch 64 --val_split 0.1 --seed 0 --units 128 --dropout 0.2 --eps 1e-08 --early_stop True --early_stop_patience 20 --early_stop_min_delta 0.0 --early_stop_warmup_evals 10 ' ===
================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:19:01.435877: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:19:01.461147: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
mkdir -p failed for path /.config/matplotlib: [Errno 13] Permission denied: '/.config'
Matplotlib created a temporary cache directory at /tmp/matplotlib-urou75yk because there was an issue with the default path (/.config/matplotlib); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
LSTM Residual Dataset:
  npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
   H  = 100
  din = 24
 dout = 6
  X_train = (61557, 100, 24), Y_train = (61557, 6)
  X_test  = (13315, 100, 24),  Y_test  = (13315, 6)
################################################

Saved scalers: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/scalers_H100.npz
X mean/std shapes: (24,)/(24,)
Y mean/std shapes: (6,)/(6,)
2026-01-29 18:19:03.623164: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:19:03.628463: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:19:03.629400: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:19:03.631009: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:19:03.632740: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:19:03.633712: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:19:03.731540: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:19:03.732470: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:19:03.733259: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:19:03.734038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8288 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
/usr/local/lib/python3.11/dist-packages/keras/src/layers/rnn/rnn.py:205: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 100, 128)       │        78,336 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 100, 128)       │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 128)            │       131,584 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 128)            │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 6)              │           774 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 210,694 (823.02 KB)
 Trainable params: 210,694 (823.02 KB)
 Non-trainable params: 0 (0.00 B)


Epoch 1/120
2026-01-29 18:19:04.996203: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
866/866 - 5s - 6ms/step - loss: 0.0892 - val_loss: 0.1009
Epoch 2/120
866/866 - 4s - 4ms/step - loss: 0.0454 - val_loss: 0.0940
Epoch 3/120
866/866 - 4s - 5ms/step - loss: 0.0395 - val_loss: 0.0908
Epoch 4/120
866/866 - 4s - 4ms/step - loss: 0.0356 - val_loss: 0.0950
Epoch 5/120
866/866 - 4s - 5ms/step - loss: 0.0339 - val_loss: 0.0905
Epoch 6/120
866/866 - 4s - 4ms/step - loss: 0.0336 - val_loss: 0.0952
Epoch 7/120
866/866 - 4s - 4ms/step - loss: 0.0311 - val_loss: 0.0917
Epoch 8/120
866/866 - 4s - 4ms/step - loss: 0.0308 - val_loss: 0.0882
Epoch 9/120
866/866 - 4s - 4ms/step - loss: 0.0298 - val_loss: 0.0929
Epoch 10/120
866/866 - 4s - 4ms/step - loss: 0.0290 - val_loss: 0.0887
Epoch 11/120
866/866 - 4s - 4ms/step - loss: 0.0285 - val_loss: 0.0946
Epoch 12/120
866/866 - 4s - 5ms/step - loss: 0.0282 - val_loss: 0.0902
Epoch 13/120
866/866 - 4s - 4ms/step - loss: 0.0275 - val_loss: 0.0894
Epoch 14/120
866/866 - 4s - 5ms/step - loss: 0.0278 - val_loss: 0.0840
Epoch 15/120
866/866 - 4s - 4ms/step - loss: 0.0274 - val_loss: 0.0886
Epoch 16/120
866/866 - 4s - 4ms/step - loss: 0.0264 - val_loss: 0.0892
Epoch 17/120
866/866 - 4s - 4ms/step - loss: 0.0263 - val_loss: 0.0877
Epoch 18/120
866/866 - 4s - 4ms/step - loss: 0.0259 - val_loss: 0.0905
Epoch 19/120
866/866 - 4s - 4ms/step - loss: 0.0256 - val_loss: 0.0880
Epoch 20/120
866/866 - 4s - 4ms/step - loss: 0.0255 - val_loss: 0.0874
Epoch 21/120
866/866 - 4s - 4ms/step - loss: 0.0252 - val_loss: 0.0919
Epoch 22/120
866/866 - 4s - 4ms/step - loss: 0.0250 - val_loss: 0.0856
Epoch 23/120
866/866 - 4s - 4ms/step - loss: 0.0245 - val_loss: 0.0891
Epoch 24/120
866/866 - 4s - 4ms/step - loss: 0.0244 - val_loss: 0.0854
Epoch 25/120
866/866 - 4s - 4ms/step - loss: 0.0253 - val_loss: 0.0819
Epoch 26/120
866/866 - 4s - 4ms/step - loss: 0.0239 - val_loss: 0.0809
Epoch 27/120
866/866 - 4s - 4ms/step - loss: 0.0238 - val_loss: 0.0900
Epoch 28/120
866/866 - 4s - 4ms/step - loss: 0.0236 - val_loss: 0.0890
Epoch 29/120
866/866 - 4s - 5ms/step - loss: 0.0235 - val_loss: 0.0829
Epoch 30/120
866/866 - 4s - 4ms/step - loss: 0.0231 - val_loss: 0.0903
Epoch 31/120
866/866 - 4s - 4ms/step - loss: 0.0231 - val_loss: 0.0972
Epoch 32/120
866/866 - 4s - 4ms/step - loss: 0.0228 - val_loss: 0.0858
Epoch 33/120
866/866 - 4s - 4ms/step - loss: 0.0228 - val_loss: 0.0863
Epoch 34/120
866/866 - 4s - 4ms/step - loss: 0.0226 - val_loss: 0.0922
Epoch 35/120
866/866 - 4s - 4ms/step - loss: 0.0222 - val_loss: 0.0932
Epoch 36/120
866/866 - 4s - 4ms/step - loss: 0.0222 - val_loss: 0.0954
Epoch 37/120
866/866 - 4s - 4ms/step - loss: 0.0226 - val_loss: 0.0903
Epoch 38/120
866/866 - 4s - 4ms/step - loss: 0.0219 - val_loss: 0.0939
Epoch 39/120
866/866 - 4s - 4ms/step - loss: 0.0218 - val_loss: 0.0940
Epoch 40/120
866/866 - 4s - 4ms/step - loss: 0.0216 - val_loss: 0.0952
Epoch 41/120
866/866 - 4s - 4ms/step - loss: 0.0217 - val_loss: 0.0956
Epoch 42/120
866/866 - 4s - 4ms/step - loss: 0.0213 - val_loss: 0.0903
Epoch 43/120
866/866 - 4s - 4ms/step - loss: 0.0212 - val_loss: 0.0905
Epoch 44/120
866/866 - 4s - 4ms/step - loss: 0.0212 - val_loss: 0.0920
Epoch 45/120
866/866 - 4s - 4ms/step - loss: 0.0211 - val_loss: 0.0961
Epoch 46/120
866/866 - 4s - 4ms/step - loss: 0.0209 - val_loss: 0.0933
Saved metrics JSON: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/metrics_train_test_H100.json

################################################
LSTM Residual Evaluation (test, unscaled units):
Total RMSE: 0.0923
Per-joint RMSE: 0.1202 0.1232 0.0886 0.0628 0.0771 0.0611
################################################

Saved predictions: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/predictions_test.npz
Saved best model:  /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_lstm.keras
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/loss_curve.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_gt_vs_pred.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_rmse_per_joint.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_rmse_time.png


##################################
### COMBINED EVAL seed=0 H=100 ###
##################################

==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/combined_evaluation.py --residual_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --model /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_lstm.keras --scalers /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/scalers_H100.npz --out_dir /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2 --H 100 --split test --features full --save_pred_npz --metrics_csv /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv --metrics_json /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl --K 84 --test_fraction 0.2 --seed 0 --dataset_seed 1 --delan_seed 3 --delan_epochs 200 --hp_preset lutter_like_256_d3 --delan_rmse_val 0.3525549655191049 --delan_rmse_test 0.3336736226108652' ===
==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:22:04.849691: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:22:04.875756: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/workspace/shared/.mplconfig is not a writable directory
Matplotlib created a temporary cache directory at /tmp/matplotlib-x_wdk2wi because there was an issue with the default path (/workspace/shared/.mplconfig); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
Evaluate & Combine
 residual_npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
 model        = /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_lstm.keras
 split        = test
 H            = 100
 n_traj       = 17
 n_dof        = 6
 feature_dim  = 24
################################################
2026-01-29 18:22:05.897371: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:05.902449: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:05.903285: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:05.904945: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:05.905732: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:05.906531: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:05.993179: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:05.994119: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:05.994946: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:05.995678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8323 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
2026-01-29 18:22:06.298035: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
  done 17/17

################################################
Stage-2 Evaluation (test, valid k>=H-1):
DeLaN torque:   MSE=1.142538e-01  RMSE=3.380145e-01
  per-joint RMSE: 0.3930 0.4766 0.3243 0.2780 0.2532 0.2395
Residual LSTM:  MSE=8.514703e-03      RMSE=9.227515e-02
  per-joint RMSE: 0.1202 0.1232 0.0886 0.0628 0.0771 0.0611
Combined torque MSE=8.514703e-03     RMSE=9.227515e-02
  per-joint RMSE: 0.1202 0.1232 0.0886 0.0628 0.0771 0.0611
################################################

Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/metrics_test_H100.txt
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/metrics_test_H100.json
Appended CSV: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv
Appended JSON: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/combined_predictions_test_H100.npz
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_gt_vs_pred_test_H100.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/torque_gt_vs_delan_vs_combined_test_H100.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/torque_rmse_per_joint_grouped_test_H100.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s0_H100_ep120_b64_u128_do0p2/torque_rmse_time_test_H100.png


###############################
### TRAIN LSTM seed=1 H=100 ###
###############################

================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T lstm bash -lc 'python3 -c '"'"'import runpy
import keras.callbacks as cb
_Orig = cb.ModelCheckpoint

class PatchedModelCheckpoint(_Orig):
    def __init__(self, filepath, *args, **kwargs):
        if isinstance(filepath, str) and (not filepath.endswith('"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"')) and (not filepath.endswith('"'"'"'"'"'"'"'"'.h5'"'"'"'"'"'"'"'"')):
            filepath = filepath + '"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"'
        super().__init__(filepath, *args, **kwargs)

cb.ModelCheckpoint = PatchedModelCheckpoint
runpy.run_path('"'"'"'"'"'"'"'"'scripts/train_residual_lstm.py'"'"'"'"'"'"'"'"', run_name='"'"'"'"'"'"'"'"'__main__'"'"'"'"'"'"'"'"')
'"'"' --npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --out_dir /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2 --model_name residual_lstm.keras --epochs 120 --batch 64 --val_split 0.1 --seed 1 --units 128 --dropout 0.2 --eps 1e-08 --early_stop True --early_stop_patience 20 --early_stop_min_delta 0.0 --early_stop_warmup_evals 10 ' ===
================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:22:08.607925: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:22:08.633773: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
mkdir -p failed for path /.config/matplotlib: [Errno 13] Permission denied: '/.config'
Matplotlib created a temporary cache directory at /tmp/matplotlib-uqp9rbi7 because there was an issue with the default path (/.config/matplotlib); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
LSTM Residual Dataset:
  npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_full__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
   H  = 100
  din = 24
 dout = 6
  X_train = (61557, 100, 24), Y_train = (61557, 6)
  X_test  = (13315, 100, 24),  Y_test  = (13315, 6)
################################################

Saved scalers: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/scalers_H100.npz
X mean/std shapes: (24,)/(24,)
Y mean/std shapes: (6,)/(6,)
2026-01-29 18:22:10.805762: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:10.811259: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:10.812431: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:10.814143: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:10.815070: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:10.815921: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:10.912409: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:10.913327: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:10.914240: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:22:10.915022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8310 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
/usr/local/lib/python3.11/dist-packages/keras/src/layers/rnn/rnn.py:205: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 100, 128)       │        78,336 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 100, 128)       │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 128)            │       131,584 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 128)            │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 6)              │           774 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 210,694 (823.02 KB)
 Trainable params: 210,694 (823.02 KB)
 Non-trainable params: 0 (0.00 B)


Epoch 1/120
2026-01-29 18:22:12.246221: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
866/866 - 5s - 6ms/step - loss: 0.0885 - val_loss: 0.1049
Epoch 2/120
866/866 - 4s - 4ms/step - loss: 0.0463 - val_loss: 0.0998
Epoch 3/120
866/866 - 4s - 4ms/step - loss: 0.0391 - val_loss: 0.1037
Epoch 4/120
866/866 - 4s - 4ms/step - loss: 0.0378 - val_loss: 0.0989
Epoch 5/120
866/866 - 4s - 4ms/step - loss: 0.0341 - val_loss: 0.0942
Epoch 6/120
866/866 - 4s - 4ms/step - loss: 0.0335 - val_loss: 0.0984
Epoch 7/120
866/866 - 4s - 4ms/step - loss: 0.0313 - val_loss: 0.0958
Epoch 8/120
866/866 - 4s - 4ms/step - loss: 0.0310 - val_loss: 0.0984
Epoch 9/120
866/866 - 4s - 4ms/step - loss: 0.0298 - val_loss: 0.0920
Epoch 10/120
866/866 - 4s - 4ms/step - loss: 0.0293 - val_loss: 0.0903
Epoch 11/120
866/866 - 4s - 4ms/step - loss: 0.0286 - val_loss: 0.0935
Epoch 12/120
866/866 - 4s - 4ms/step - loss: 0.0282 - val_loss: 0.0917
Epoch 13/120
866/866 - 4s - 4ms/step - loss: 0.0281 - val_loss: 0.0955
Epoch 14/120
866/866 - 4s - 4ms/step - loss: 0.0273 - val_loss: 0.0928
Epoch 15/120
866/866 - 4s - 4ms/step - loss: 0.0269 - val_loss: 0.0914
Epoch 16/120
866/866 - 4s - 4ms/step - loss: 0.0267 - val_loss: 0.0911
Epoch 17/120
866/866 - 4s - 5ms/step - loss: 0.0262 - val_loss: 0.0887
Epoch 18/120
866/866 - 4s - 5ms/step - loss: 0.0261 - val_loss: 0.0907
Epoch 19/120
866/866 - 4s - 4ms/step - loss: 0.0256 - val_loss: 0.0936
Epoch 20/120
866/866 - 4s - 5ms/step - loss: 0.0255 - val_loss: 0.0936
Epoch 21/120
866/866 - 4s - 5ms/step - loss: 0.0251 - val_loss: 0.0933
Epoch 22/120
866/866 - 4s - 5ms/step - loss: 0.0251 - val_loss: 0.0943
Epoch 23/120
866/866 - 4s - 4ms/step - loss: 0.0249 - val_loss: 0.0934
Epoch 24/120
866/866 - 4s - 4ms/step - loss: 0.0245 - val_loss: 0.0928
Epoch 25/120
866/866 - 4s - 5ms/step - loss: 0.0243 - val_loss: 0.0913
Epoch 26/120
866/866 - 4s - 4ms/step - loss: 0.0241 - val_loss: 0.0987
Epoch 27/120
866/866 - 4s - 4ms/step - loss: 0.0237 - val_loss: 0.0907
Epoch 28/120
866/866 - 4s - 4ms/step - loss: 0.0235 - val_loss: 0.0953
Epoch 29/120
866/866 - 4s - 4ms/step - loss: 0.0235 - val_loss: 0.0904
Epoch 30/120
866/866 - 4s - 4ms/step - loss: 0.0232 - val_loss: 0.0962
Epoch 31/120
866/866 - 4s - 5ms/step - loss: 0.0230 - val_loss: 0.0961
Epoch 32/120
866/866 - 4s - 4ms/step - loss: 0.0229 - val_loss: 0.0914
Epoch 33/120
866/866 - 4s - 5ms/step - loss: 0.0228 - val_loss: 0.0998
Epoch 34/120
866/866 - 4s - 4ms/step - loss: 0.0227 - val_loss: 0.0983
Epoch 35/120
866/866 - 4s - 4ms/step - loss: 0.0223 - val_loss: 0.0977
Epoch 36/120
866/866 - 4s - 4ms/step - loss: 0.0223 - val_loss: 0.0955
Epoch 37/120
866/866 - 4s - 4ms/step - loss: 0.0221 - val_loss: 0.0942
Saved metrics JSON: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/metrics_train_test_H100.json

################################################
LSTM Residual Evaluation (test, unscaled units):
Total RMSE: 0.0889
Per-joint RMSE: 0.1080 0.1062 0.0985 0.0693 0.0823 0.0561
################################################

Saved predictions: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/predictions_test.npz
Saved best model:  /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_lstm.keras
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/loss_curve.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_gt_vs_pred.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_rmse_per_joint.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_rmse_time.png


##################################
### COMBINED EVAL seed=1 H=100 ###
##################################

==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/combined_evaluation.py --residual_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --model /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_lstm.keras --scalers /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/scalers_H100.npz --out_dir /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2 --H 100 --split test --features full --save_pred_npz --metrics_csv /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv --metrics_json /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl --K 84 --test_fraction 0.2 --seed 1 --dataset_seed 1 --delan_seed 3 --delan_epochs 200 --hp_preset lutter_like_256_d3 --delan_rmse_val 0.3525549655191049 --delan_rmse_test 0.3336736226108652' ===
==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:24:38.485092: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:24:38.512010: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/workspace/shared/.mplconfig is not a writable directory
Matplotlib created a temporary cache directory at /tmp/matplotlib-eiqecfyk because there was an issue with the default path (/workspace/shared/.mplconfig); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
Evaluate & Combine
 residual_npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
 model        = /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_lstm.keras
 split        = test
 H            = 100
 n_traj       = 17
 n_dof        = 6
 feature_dim  = 24
################################################
2026-01-29 18:24:39.580406: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:39.585812: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:39.586616: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:39.588390: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:39.589186: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:39.589930: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:39.671886: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:39.672751: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:39.673639: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:39.674432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8397 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
2026-01-29 18:24:39.979884: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
  done 17/17

################################################
Stage-2 Evaluation (test, valid k>=H-1):
DeLaN torque:   MSE=1.142538e-01  RMSE=3.380145e-01
  per-joint RMSE: 0.3930 0.4766 0.3243 0.2780 0.2532 0.2395
Residual LSTM:  MSE=7.894407e-03      RMSE=8.885048e-02
  per-joint RMSE: 0.1080 0.1062 0.0985 0.0693 0.0823 0.0561
Combined torque MSE=7.894407e-03     RMSE=8.885048e-02
  per-joint RMSE: 0.1080 0.1062 0.0985 0.0693 0.0823 0.0561
################################################

Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/metrics_test_H100.txt
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/metrics_test_H100.json
Appended CSV: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv
Appended JSON: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/combined_predictions_test_H100.npz
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_gt_vs_pred_test_H100.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/torque_gt_vs_delan_vs_combined_test_H100.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/torque_rmse_per_joint_grouped_test_H100.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_full__lstm_best_s1_H100_ep120_b64_u128_do0p2/torque_rmse_time_test_H100.png


###############################
### CONFIG: feat=state H=50 ###
###############################

##########################################
### BUILD LSTM WINDOWS H=50 feat=state ###
##########################################

===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T preprocess bash -lc 'python3 scripts/build_lstm_windows.py --in_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --out_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --H 50 --features state' ===
===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Building LSTM windows
  in_npz      = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
  out_npz     = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
  H           = 50
  feature_mode= state
Saved: /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
Saved: /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.json
H=50, n_dof=6, feature_dim=18
X_train: (64507, 50, 18)  Y_train: (64507, 6)
X_test : (14165, 50, 18)  Y_test : (14165, 6)
feature_mode=state


##############################
### TRAIN LSTM seed=0 H=50 ###
##############################

================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T lstm bash -lc 'python3 -c '"'"'import runpy
import keras.callbacks as cb
_Orig = cb.ModelCheckpoint

class PatchedModelCheckpoint(_Orig):
    def __init__(self, filepath, *args, **kwargs):
        if isinstance(filepath, str) and (not filepath.endswith('"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"')) and (not filepath.endswith('"'"'"'"'"'"'"'"'.h5'"'"'"'"'"'"'"'"')):
            filepath = filepath + '"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"'
        super().__init__(filepath, *args, **kwargs)

cb.ModelCheckpoint = PatchedModelCheckpoint
runpy.run_path('"'"'"'"'"'"'"'"'scripts/train_residual_lstm.py'"'"'"'"'"'"'"'"', run_name='"'"'"'"'"'"'"'"'__main__'"'"'"'"'"'"'"'"')
'"'"' --npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --out_dir /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2 --model_name residual_lstm.keras --epochs 120 --batch 64 --val_split 0.1 --seed 0 --units 128 --dropout 0.2 --eps 1e-08 --early_stop True --early_stop_patience 20 --early_stop_min_delta 0.0 --early_stop_warmup_evals 10 ' ===
================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:24:42.861412: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:24:42.887235: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
mkdir -p failed for path /.config/matplotlib: [Errno 13] Permission denied: '/.config'
Matplotlib created a temporary cache directory at /tmp/matplotlib-7dr_h15q because there was an issue with the default path (/.config/matplotlib); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
LSTM Residual Dataset:
  npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
   H  = 50
  din = 18
 dout = 6
  X_train = (64507, 50, 18), Y_train = (64507, 6)
  X_test  = (14165, 50, 18),  Y_test  = (14165, 6)
################################################

Saved scalers: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/scalers_H50.npz
X mean/std shapes: (18,)/(18,)
Y mean/std shapes: (6,)/(6,)
2026-01-29 18:24:44.414196: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:44.419714: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:44.420742: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:44.422525: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:44.423434: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:44.424399: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:44.523996: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:44.524913: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:44.525810: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:24:44.527403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8395 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
/usr/local/lib/python3.11/dist-packages/keras/src/layers/rnn/rnn.py:205: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 50, 128)        │        75,264 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 50, 128)        │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 128)            │       131,584 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 128)            │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 6)              │           774 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 207,622 (811.02 KB)
 Trainable params: 207,622 (811.02 KB)
 Non-trainable params: 0 (0.00 B)


Epoch 1/120
2026-01-29 18:24:45.631117: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
908/908 - 4s - 4ms/step - loss: 0.0915 - val_loss: 0.1037
Epoch 2/120
908/908 - 3s - 3ms/step - loss: 0.0488 - val_loss: 0.0998
Epoch 3/120
908/908 - 3s - 3ms/step - loss: 0.0422 - val_loss: 0.1027
Epoch 4/120
908/908 - 3s - 3ms/step - loss: 0.0383 - val_loss: 0.1068
Epoch 5/120
908/908 - 3s - 3ms/step - loss: 0.0361 - val_loss: 0.1103
Epoch 6/120
908/908 - 3s - 3ms/step - loss: 0.0342 - val_loss: 0.1009
Epoch 7/120
908/908 - 3s - 3ms/step - loss: 0.0329 - val_loss: 0.0997
Epoch 8/120
908/908 - 3s - 3ms/step - loss: 0.0327 - val_loss: 0.0988
Epoch 9/120
908/908 - 3s - 3ms/step - loss: 0.0308 - val_loss: 0.0996
Epoch 10/120
908/908 - 3s - 3ms/step - loss: 0.0305 - val_loss: 0.0986
Epoch 11/120
908/908 - 3s - 3ms/step - loss: 0.0295 - val_loss: 0.0986
Epoch 12/120
908/908 - 3s - 3ms/step - loss: 0.0288 - val_loss: 0.0976
Epoch 13/120
908/908 - 3s - 3ms/step - loss: 0.0288 - val_loss: 0.0989
Epoch 14/120
908/908 - 3s - 3ms/step - loss: 0.0282 - val_loss: 0.0970
Epoch 15/120
908/908 - 3s - 3ms/step - loss: 0.0278 - val_loss: 0.0936
Epoch 16/120
908/908 - 3s - 3ms/step - loss: 0.0275 - val_loss: 0.0924
Epoch 17/120
908/908 - 3s - 3ms/step - loss: 0.0270 - val_loss: 0.0958
Epoch 18/120
908/908 - 3s - 3ms/step - loss: 0.0269 - val_loss: 0.0966
Epoch 19/120
908/908 - 3s - 3ms/step - loss: 0.0264 - val_loss: 0.0951
Epoch 20/120
908/908 - 3s - 3ms/step - loss: 0.0264 - val_loss: 0.0924
Epoch 21/120
908/908 - 3s - 3ms/step - loss: 0.0259 - val_loss: 0.0971
Epoch 22/120
908/908 - 3s - 3ms/step - loss: 0.0257 - val_loss: 0.0944
Epoch 23/120
908/908 - 3s - 3ms/step - loss: 0.0257 - val_loss: 0.0917
Epoch 24/120
908/908 - 3s - 3ms/step - loss: 0.0256 - val_loss: 0.0949
Epoch 25/120
908/908 - 3s - 3ms/step - loss: 0.0254 - val_loss: 0.0942
Epoch 26/120
908/908 - 3s - 3ms/step - loss: 0.0252 - val_loss: 0.0927
Epoch 27/120
908/908 - 3s - 3ms/step - loss: 0.0248 - val_loss: 0.0917
Epoch 28/120
908/908 - 3s - 3ms/step - loss: 0.0247 - val_loss: 0.0948
Epoch 29/120
908/908 - 3s - 3ms/step - loss: 0.0247 - val_loss: 0.0927
Epoch 30/120
908/908 - 3s - 3ms/step - loss: 0.0252 - val_loss: 0.0923
Epoch 31/120
908/908 - 3s - 3ms/step - loss: 0.0242 - val_loss: 0.0898
Epoch 32/120
908/908 - 3s - 3ms/step - loss: 0.0240 - val_loss: 0.0900
Epoch 33/120
908/908 - 3s - 3ms/step - loss: 0.0241 - val_loss: 0.0944
Epoch 34/120
908/908 - 3s - 3ms/step - loss: 0.0239 - val_loss: 0.0911
Epoch 35/120
908/908 - 3s - 3ms/step - loss: 0.0238 - val_loss: 0.0914
Epoch 36/120
908/908 - 3s - 3ms/step - loss: 0.0235 - val_loss: 0.0933
Epoch 37/120
908/908 - 3s - 3ms/step - loss: 0.0236 - val_loss: 0.0901
Epoch 38/120
908/908 - 3s - 3ms/step - loss: 0.0232 - val_loss: 0.0926
Epoch 39/120
908/908 - 3s - 3ms/step - loss: 0.0232 - val_loss: 0.0919
Epoch 40/120
908/908 - 3s - 3ms/step - loss: 0.0230 - val_loss: 0.0916
Epoch 41/120
908/908 - 3s - 3ms/step - loss: 0.0230 - val_loss: 0.0965
Epoch 42/120
908/908 - 3s - 3ms/step - loss: 0.0231 - val_loss: 0.0895
Epoch 43/120
908/908 - 3s - 3ms/step - loss: 0.0227 - val_loss: 0.0941
Epoch 44/120
908/908 - 3s - 3ms/step - loss: 0.0226 - val_loss: 0.0932
Epoch 45/120
908/908 - 3s - 3ms/step - loss: 0.0224 - val_loss: 0.0898
Epoch 46/120
908/908 - 3s - 3ms/step - loss: 0.0226 - val_loss: 0.0877
Epoch 47/120
908/908 - 3s - 3ms/step - loss: 0.0229 - val_loss: 0.0887
Epoch 48/120
908/908 - 3s - 3ms/step - loss: 0.0221 - val_loss: 0.0885
Epoch 49/120
908/908 - 3s - 3ms/step - loss: 0.0218 - val_loss: 0.0888
Epoch 50/120
908/908 - 3s - 3ms/step - loss: 0.0219 - val_loss: 0.0902
Epoch 51/120
908/908 - 3s - 3ms/step - loss: 0.0217 - val_loss: 0.0919
Epoch 52/120
908/908 - 3s - 3ms/step - loss: 0.0221 - val_loss: 0.0890
Epoch 53/120
908/908 - 3s - 3ms/step - loss: 0.0216 - val_loss: 0.0894
Epoch 54/120
908/908 - 3s - 3ms/step - loss: 0.0215 - val_loss: 0.0920
Epoch 55/120
908/908 - 3s - 3ms/step - loss: 0.0214 - val_loss: 0.0911
Epoch 56/120
908/908 - 3s - 3ms/step - loss: 0.0213 - val_loss: 0.0902
Epoch 57/120
908/908 - 3s - 3ms/step - loss: 0.0212 - val_loss: 0.0926
Epoch 58/120
908/908 - 3s - 3ms/step - loss: 0.0213 - val_loss: 0.0909
Epoch 59/120
908/908 - 3s - 3ms/step - loss: 0.0211 - val_loss: 0.0916
Epoch 60/120
908/908 - 3s - 3ms/step - loss: 0.0211 - val_loss: 0.0923
Epoch 61/120
908/908 - 3s - 3ms/step - loss: 0.0211 - val_loss: 0.0901
Epoch 62/120
908/908 - 3s - 3ms/step - loss: 0.0209 - val_loss: 0.0910
Epoch 63/120
908/908 - 3s - 3ms/step - loss: 0.0212 - val_loss: 0.0907
Epoch 64/120
908/908 - 3s - 3ms/step - loss: 0.0208 - val_loss: 0.0943
Epoch 65/120
908/908 - 3s - 3ms/step - loss: 0.0208 - val_loss: 0.0928
Epoch 66/120
908/908 - 3s - 3ms/step - loss: 0.0206 - val_loss: 0.0925
Saved metrics JSON: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/metrics_train_test_H50.json

################################################
LSTM Residual Evaluation (test, unscaled units):
Total RMSE: 0.0933
Per-joint RMSE: 0.1213 0.0982 0.0971 0.0659 0.0932 0.0736
################################################

Saved predictions: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/predictions_test.npz
Saved best model:  /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_lstm.keras
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/loss_curve.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_gt_vs_pred.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_rmse_per_joint.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_rmse_time.png


#################################
### COMBINED EVAL seed=0 H=50 ###
#################################

=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/combined_evaluation.py --residual_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --model /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_lstm.keras --scalers /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/scalers_H50.npz --out_dir /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2 --H 50 --split test --features state --save_pred_npz --metrics_csv /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv --metrics_json /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl --K 84 --test_fraction 0.2 --seed 0 --dataset_seed 1 --delan_seed 3 --delan_epochs 200 --hp_preset lutter_like_256_d3 --delan_rmse_val 0.3525549655191049 --delan_rmse_test 0.3336736226108652' ===
=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:27:44.422535: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:27:44.449093: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/workspace/shared/.mplconfig is not a writable directory
Matplotlib created a temporary cache directory at /tmp/matplotlib-rvbr14ec because there was an issue with the default path (/workspace/shared/.mplconfig); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
Evaluate & Combine
 residual_npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
 model        = /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_lstm.keras
 split        = test
 H            = 50
 n_traj       = 17
 n_dof        = 6
 feature_dim  = 18
################################################
2026-01-29 18:27:45.485807: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:45.490895: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:45.491772: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:45.493580: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:45.494378: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:45.495110: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:45.572702: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:45.573669: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:45.574421: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:45.575236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8770 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
2026-01-29 18:27:45.882166: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
  done 17/17

################################################
Stage-2 Evaluation (test, valid k>=H-1):
DeLaN torque:   MSE=1.134792e-01  RMSE=3.368667e-01
  per-joint RMSE: 0.3925 0.4749 0.3226 0.2785 0.2512 0.2379
Residual LSTM:  MSE=8.704990e-03      RMSE=9.330054e-02
  per-joint RMSE: 0.1213 0.0982 0.0971 0.0659 0.0932 0.0736
Combined torque MSE=8.704990e-03     RMSE=9.330054e-02
  per-joint RMSE: 0.1213 0.0982 0.0971 0.0659 0.0932 0.0736
################################################

Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/metrics_test_H50.txt
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/metrics_test_H50.json
Appended CSV: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv
Appended JSON: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/combined_predictions_test_H50.npz
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/residual_gt_vs_pred_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/torque_gt_vs_delan_vs_combined_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/torque_rmse_per_joint_grouped_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H50_ep120_b64_u128_do0p2/torque_rmse_time_test_H50.png


##############################
### TRAIN LSTM seed=1 H=50 ###
##############################

================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T lstm bash -lc 'python3 -c '"'"'import runpy
import keras.callbacks as cb
_Orig = cb.ModelCheckpoint

class PatchedModelCheckpoint(_Orig):
    def __init__(self, filepath, *args, **kwargs):
        if isinstance(filepath, str) and (not filepath.endswith('"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"')) and (not filepath.endswith('"'"'"'"'"'"'"'"'.h5'"'"'"'"'"'"'"'"')):
            filepath = filepath + '"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"'
        super().__init__(filepath, *args, **kwargs)

cb.ModelCheckpoint = PatchedModelCheckpoint
runpy.run_path('"'"'"'"'"'"'"'"'scripts/train_residual_lstm.py'"'"'"'"'"'"'"'"', run_name='"'"'"'"'"'"'"'"'__main__'"'"'"'"'"'"'"'"')
'"'"' --npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --out_dir /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2 --model_name residual_lstm.keras --epochs 120 --batch 64 --val_split 0.1 --seed 1 --units 128 --dropout 0.2 --eps 1e-08 --early_stop True --early_stop_patience 20 --early_stop_min_delta 0.0 --early_stop_warmup_evals 10 ' ===
================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:27:48.145969: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:27:48.172818: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
mkdir -p failed for path /.config/matplotlib: [Errno 13] Permission denied: '/.config'
Matplotlib created a temporary cache directory at /tmp/matplotlib-dp46tzfe because there was an issue with the default path (/.config/matplotlib); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
LSTM Residual Dataset:
  npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H50__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
   H  = 50
  din = 18
 dout = 6
  X_train = (64507, 50, 18), Y_train = (64507, 6)
  X_test  = (14165, 50, 18),  Y_test  = (14165, 6)
################################################

Saved scalers: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/scalers_H50.npz
X mean/std shapes: (18,)/(18,)
Y mean/std shapes: (6,)/(6,)
2026-01-29 18:27:49.710473: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:49.715379: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:49.716293: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:49.717994: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:49.719484: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:49.720340: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:49.804985: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:49.805904: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:49.806701: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:27:49.807501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8759 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
/usr/local/lib/python3.11/dist-packages/keras/src/layers/rnn/rnn.py:205: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 50, 128)        │        75,264 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 50, 128)        │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 128)            │       131,584 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 128)            │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 6)              │           774 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 207,622 (811.02 KB)
 Trainable params: 207,622 (811.02 KB)
 Non-trainable params: 0 (0.00 B)


Epoch 1/120
2026-01-29 18:27:50.936442: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
908/908 - 4s - 5ms/step - loss: 0.0926 - val_loss: 0.1064
Epoch 2/120
908/908 - 3s - 3ms/step - loss: 0.0488 - val_loss: 0.1068
Epoch 3/120
908/908 - 3s - 3ms/step - loss: 0.0416 - val_loss: 0.1094
Epoch 4/120
908/908 - 3s - 3ms/step - loss: 0.0385 - val_loss: 0.1039
Epoch 5/120
908/908 - 3s - 3ms/step - loss: 0.0353 - val_loss: 0.1054
Epoch 6/120
908/908 - 3s - 3ms/step - loss: 0.0338 - val_loss: 0.0967
Epoch 7/120
908/908 - 3s - 3ms/step - loss: 0.0326 - val_loss: 0.0969
Epoch 8/120
908/908 - 3s - 3ms/step - loss: 0.0314 - val_loss: 0.1010
Epoch 9/120
908/908 - 3s - 3ms/step - loss: 0.0307 - val_loss: 0.0982
Epoch 10/120
908/908 - 3s - 3ms/step - loss: 0.0299 - val_loss: 0.1002
Epoch 11/120
908/908 - 3s - 3ms/step - loss: 0.0296 - val_loss: 0.1013
Epoch 12/120
908/908 - 3s - 3ms/step - loss: 0.0299 - val_loss: 0.0999
Epoch 13/120
908/908 - 3s - 3ms/step - loss: 0.0281 - val_loss: 0.0956
Epoch 14/120
908/908 - 3s - 3ms/step - loss: 0.0276 - val_loss: 0.0992
Epoch 15/120
908/908 - 3s - 3ms/step - loss: 0.0273 - val_loss: 0.0953
Epoch 16/120
908/908 - 3s - 3ms/step - loss: 0.0275 - val_loss: 0.0959
Epoch 17/120
908/908 - 3s - 3ms/step - loss: 0.0265 - val_loss: 0.0937
Epoch 18/120
908/908 - 3s - 3ms/step - loss: 0.0266 - val_loss: 0.0984
Epoch 19/120
908/908 - 3s - 3ms/step - loss: 0.0267 - val_loss: 0.0950
Epoch 20/120
908/908 - 3s - 3ms/step - loss: 0.0261 - val_loss: 0.0919
Epoch 21/120
908/908 - 3s - 3ms/step - loss: 0.0258 - val_loss: 0.0950
Epoch 22/120
908/908 - 3s - 3ms/step - loss: 0.0260 - val_loss: 0.0947
Epoch 23/120
908/908 - 3s - 3ms/step - loss: 0.0257 - val_loss: 0.0936
Epoch 24/120
908/908 - 3s - 3ms/step - loss: 0.0255 - val_loss: 0.0957
Epoch 25/120
908/908 - 3s - 3ms/step - loss: 0.0252 - val_loss: 0.0923
Epoch 26/120
908/908 - 3s - 3ms/step - loss: 0.0252 - val_loss: 0.0941
Epoch 27/120
908/908 - 3s - 3ms/step - loss: 0.0248 - val_loss: 0.0961
Epoch 28/120
908/908 - 3s - 3ms/step - loss: 0.0249 - val_loss: 0.0931
Epoch 29/120
908/908 - 3s - 3ms/step - loss: 0.0246 - val_loss: 0.0948
Epoch 30/120
908/908 - 3s - 3ms/step - loss: 0.0244 - val_loss: 0.0945
Epoch 31/120
908/908 - 3s - 3ms/step - loss: 0.0244 - val_loss: 0.0942
Epoch 32/120
908/908 - 3s - 3ms/step - loss: 0.0240 - val_loss: 0.0927
Epoch 33/120
908/908 - 3s - 3ms/step - loss: 0.0238 - val_loss: 0.0943
Epoch 34/120
908/908 - 3s - 3ms/step - loss: 0.0238 - val_loss: 0.0981
Epoch 35/120
908/908 - 3s - 3ms/step - loss: 0.0235 - val_loss: 0.0952
Epoch 36/120
908/908 - 3s - 3ms/step - loss: 0.0241 - val_loss: 0.0939
Epoch 37/120
908/908 - 3s - 3ms/step - loss: 0.0232 - val_loss: 0.0961
Epoch 38/120
908/908 - 3s - 3ms/step - loss: 0.0231 - val_loss: 0.0949
Epoch 39/120
908/908 - 3s - 3ms/step - loss: 0.0229 - val_loss: 0.0938
Epoch 40/120
908/908 - 3s - 3ms/step - loss: 0.0228 - val_loss: 0.0916
Epoch 41/120
908/908 - 3s - 3ms/step - loss: 0.0227 - val_loss: 0.0916
Epoch 42/120
908/908 - 3s - 3ms/step - loss: 0.0227 - val_loss: 0.0929
Epoch 43/120
908/908 - 3s - 3ms/step - loss: 0.0223 - val_loss: 0.0947
Epoch 44/120
908/908 - 3s - 3ms/step - loss: 0.0225 - val_loss: 0.0930
Epoch 45/120
908/908 - 3s - 3ms/step - loss: 0.0222 - val_loss: 0.0920
Epoch 46/120
908/908 - 3s - 3ms/step - loss: 0.0221 - val_loss: 0.0908
Epoch 47/120
908/908 - 3s - 3ms/step - loss: 0.0220 - val_loss: 0.0914
Epoch 48/120
908/908 - 3s - 3ms/step - loss: 0.0223 - val_loss: 0.0944
Epoch 49/120
908/908 - 3s - 3ms/step - loss: 0.0218 - val_loss: 0.0944
Epoch 50/120
908/908 - 3s - 3ms/step - loss: 0.0220 - val_loss: 0.0934
Epoch 51/120
908/908 - 3s - 3ms/step - loss: 0.0215 - val_loss: 0.0921
Epoch 52/120
908/908 - 3s - 3ms/step - loss: 0.0214 - val_loss: 0.0922
Epoch 53/120
908/908 - 3s - 3ms/step - loss: 0.0214 - val_loss: 0.0920
Epoch 54/120
908/908 - 3s - 3ms/step - loss: 0.0214 - val_loss: 0.0927
Epoch 55/120
908/908 - 3s - 3ms/step - loss: 0.0213 - val_loss: 0.0949
Epoch 56/120
908/908 - 3s - 3ms/step - loss: 0.0211 - val_loss: 0.0952
Epoch 57/120
908/908 - 3s - 3ms/step - loss: 0.0212 - val_loss: 0.0946
Epoch 58/120
908/908 - 3s - 3ms/step - loss: 0.0211 - val_loss: 0.0912
Epoch 59/120
908/908 - 3s - 3ms/step - loss: 0.0210 - val_loss: 0.0918
Epoch 60/120
908/908 - 3s - 3ms/step - loss: 0.0209 - val_loss: 0.0931
Epoch 61/120
908/908 - 3s - 3ms/step - loss: 0.0211 - val_loss: 0.0914
Epoch 62/120
908/908 - 3s - 3ms/step - loss: 0.0209 - val_loss: 0.0918
Epoch 63/120
908/908 - 3s - 3ms/step - loss: 0.0209 - val_loss: 0.0933
Epoch 64/120
908/908 - 3s - 3ms/step - loss: 0.0207 - val_loss: 0.0939
Epoch 65/120
908/908 - 3s - 3ms/step - loss: 0.0208 - val_loss: 0.0916
Epoch 66/120
908/908 - 3s - 3ms/step - loss: 0.0205 - val_loss: 0.0930
Saved metrics JSON: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/metrics_train_test_H50.json

################################################
LSTM Residual Evaluation (test, unscaled units):
Total RMSE: 0.0902
Per-joint RMSE: 0.1095 0.0963 0.0873 0.0709 0.0996 0.0709
################################################

Saved predictions: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/predictions_test.npz
Saved best model:  /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_lstm.keras
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/loss_curve.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_gt_vs_pred.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_rmse_per_joint.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_rmse_time.png


#################################
### COMBINED EVAL seed=1 H=50 ###
#################################

=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/combined_evaluation.py --residual_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --model /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_lstm.keras --scalers /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/scalers_H50.npz --out_dir /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2 --H 50 --split test --features state --save_pred_npz --metrics_csv /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv --metrics_json /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl --K 84 --test_fraction 0.2 --seed 1 --dataset_seed 1 --delan_seed 3 --delan_epochs 200 --hp_preset lutter_like_256_d3 --delan_rmse_val 0.3525549655191049 --delan_rmse_test 0.3336736226108652' ===
=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:30:50.258758: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:30:50.285615: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/workspace/shared/.mplconfig is not a writable directory
Matplotlib created a temporary cache directory at /tmp/matplotlib-9fm53b3n because there was an issue with the default path (/workspace/shared/.mplconfig); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
Evaluate & Combine
 residual_npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
 model        = /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_lstm.keras
 split        = test
 H            = 50
 n_traj       = 17
 n_dof        = 6
 feature_dim  = 18
################################################
2026-01-29 18:30:51.339079: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:51.344324: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:51.345208: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:51.346954: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:51.347764: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:51.348500: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:51.427088: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:51.427940: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:51.428756: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:51.429487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8793 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
2026-01-29 18:30:51.735013: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
  done 17/17

################################################
Stage-2 Evaluation (test, valid k>=H-1):
DeLaN torque:   MSE=1.134792e-01  RMSE=3.368667e-01
  per-joint RMSE: 0.3925 0.4749 0.3226 0.2785 0.2512 0.2379
Residual LSTM:  MSE=8.143837e-03      RMSE=9.024321e-02
  per-joint RMSE: 0.1095 0.0963 0.0873 0.0709 0.0996 0.0709
Combined torque MSE=8.143837e-03     RMSE=9.024321e-02
  per-joint RMSE: 0.1095 0.0963 0.0873 0.0709 0.0996 0.0709
################################################

Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/metrics_test_H50.txt
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/metrics_test_H50.json
Appended CSV: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv
Appended JSON: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/combined_predictions_test_H50.npz
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/residual_gt_vs_pred_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/torque_gt_vs_delan_vs_combined_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/torque_rmse_per_joint_grouped_test_H50.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H50_ep120_b64_u128_do0p2/torque_rmse_time_test_H50.png


################################
### CONFIG: feat=state H=100 ###
################################

###########################################
### BUILD LSTM WINDOWS H=100 feat=state ###
###########################################

=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T preprocess bash -lc 'python3 scripts/build_lstm_windows.py --in_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --out_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --H 100 --features state' ===
=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Building LSTM windows
  in_npz      = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
  out_npz     = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
  H           = 100
  feature_mode= state
Saved: /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
Saved: /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.json
H=100, n_dof=6, feature_dim=18
X_train: (61557, 100, 18)  Y_train: (61557, 6)
X_test : (13315, 100, 18)  Y_test : (13315, 6)
feature_mode=state


###############################
### TRAIN LSTM seed=0 H=100 ###
###############################

==================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T lstm bash -lc 'python3 -c '"'"'import runpy
import keras.callbacks as cb
_Orig = cb.ModelCheckpoint

class PatchedModelCheckpoint(_Orig):
    def __init__(self, filepath, *args, **kwargs):
        if isinstance(filepath, str) and (not filepath.endswith('"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"')) and (not filepath.endswith('"'"'"'"'"'"'"'"'.h5'"'"'"'"'"'"'"'"')):
            filepath = filepath + '"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"'
        super().__init__(filepath, *args, **kwargs)

cb.ModelCheckpoint = PatchedModelCheckpoint
runpy.run_path('"'"'"'"'"'"'"'"'scripts/train_residual_lstm.py'"'"'"'"'"'"'"'"', run_name='"'"'"'"'"'"'"'"'__main__'"'"'"'"'"'"'"'"')
'"'"' --npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --out_dir /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2 --model_name residual_lstm.keras --epochs 120 --batch 64 --val_split 0.1 --seed 0 --units 128 --dropout 0.2 --eps 1e-08 --early_stop True --early_stop_patience 20 --early_stop_min_delta 0.0 --early_stop_warmup_evals 10 ' ===
==================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:30:54.755389: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:30:54.780446: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
mkdir -p failed for path /.config/matplotlib: [Errno 13] Permission denied: '/.config'
Matplotlib created a temporary cache directory at /tmp/matplotlib-sr3doxnt because there was an issue with the default path (/.config/matplotlib); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
LSTM Residual Dataset:
  npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
   H  = 100
  din = 18
 dout = 6
  X_train = (61557, 100, 18), Y_train = (61557, 6)
  X_test  = (13315, 100, 18),  Y_test  = (13315, 6)
################################################

Saved scalers: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/scalers_H100.npz
X mean/std shapes: (18,)/(18,)
Y mean/std shapes: (6,)/(6,)
2026-01-29 18:30:56.710851: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:56.715962: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:56.716884: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:56.718621: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:56.719518: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:56.720258: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:56.807081: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:56.807972: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:56.808765: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:30:56.809558: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8782 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
/usr/local/lib/python3.11/dist-packages/keras/src/layers/rnn/rnn.py:205: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 100, 128)       │        75,264 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 100, 128)       │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 128)            │       131,584 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 128)            │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 6)              │           774 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 207,622 (811.02 KB)
 Trainable params: 207,622 (811.02 KB)
 Non-trainable params: 0 (0.00 B)


Epoch 1/120
2026-01-29 18:30:58.102882: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
866/866 - 5s - 6ms/step - loss: 0.0924 - val_loss: 0.1072
Epoch 2/120
866/866 - 4s - 4ms/step - loss: 0.0487 - val_loss: 0.1035
Epoch 3/120
866/866 - 4s - 4ms/step - loss: 0.0417 - val_loss: 0.0988
Epoch 4/120
866/866 - 4s - 4ms/step - loss: 0.0400 - val_loss: 0.1010
Epoch 5/120
866/866 - 4s - 4ms/step - loss: 0.0361 - val_loss: 0.0954
Epoch 6/120
866/866 - 4s - 4ms/step - loss: 0.0339 - val_loss: 0.1012
Epoch 7/120
866/866 - 4s - 4ms/step - loss: 0.0328 - val_loss: 0.0968
Epoch 8/120
866/866 - 4s - 4ms/step - loss: 0.0328 - val_loss: 0.0928
Epoch 9/120
866/866 - 4s - 4ms/step - loss: 0.0309 - val_loss: 0.0960
Epoch 10/120
866/866 - 4s - 4ms/step - loss: 0.0304 - val_loss: 0.0941
Epoch 11/120
866/866 - 4s - 4ms/step - loss: 0.0296 - val_loss: 0.0961
Epoch 12/120
866/866 - 4s - 4ms/step - loss: 0.0289 - val_loss: 0.0973
Epoch 13/120
866/866 - 4s - 4ms/step - loss: 0.0283 - val_loss: 0.0964
Epoch 14/120
866/866 - 4s - 4ms/step - loss: 0.0289 - val_loss: 0.0969
Epoch 15/120
866/866 - 4s - 4ms/step - loss: 0.0281 - val_loss: 0.0969
Epoch 16/120
866/866 - 4s - 4ms/step - loss: 0.0278 - val_loss: 0.0951
Epoch 17/120
866/866 - 4s - 4ms/step - loss: 0.0271 - val_loss: 0.0953
Epoch 18/120
866/866 - 4s - 4ms/step - loss: 0.0270 - val_loss: 0.0914
Epoch 19/120
866/866 - 4s - 4ms/step - loss: 0.0263 - val_loss: 0.0934
Epoch 20/120
866/866 - 4s - 5ms/step - loss: 0.0266 - val_loss: 0.0942
Epoch 21/120
866/866 - 4s - 5ms/step - loss: 0.0263 - val_loss: 0.0921
Epoch 22/120
866/866 - 4s - 5ms/step - loss: 0.0259 - val_loss: 0.0924
Epoch 23/120
866/866 - 4s - 5ms/step - loss: 0.0257 - val_loss: 0.0922
Epoch 24/120
866/866 - 4s - 4ms/step - loss: 0.0255 - val_loss: 0.0923
Epoch 25/120
866/866 - 4s - 4ms/step - loss: 0.0253 - val_loss: 0.0941
Epoch 26/120
866/866 - 4s - 5ms/step - loss: 0.0252 - val_loss: 0.0927
Epoch 27/120
866/866 - 4s - 5ms/step - loss: 0.0255 - val_loss: 0.0900
Epoch 28/120
866/866 - 4s - 4ms/step - loss: 0.0247 - val_loss: 0.0900
Epoch 29/120
866/866 - 4s - 5ms/step - loss: 0.0248 - val_loss: 0.0954
Epoch 30/120
866/866 - 4s - 5ms/step - loss: 0.0246 - val_loss: 0.0908
Epoch 31/120
866/866 - 4s - 4ms/step - loss: 0.0245 - val_loss: 0.0902
Epoch 32/120
866/866 - 4s - 4ms/step - loss: 0.0243 - val_loss: 0.0912
Epoch 33/120
866/866 - 4s - 4ms/step - loss: 0.0242 - val_loss: 0.0903
Epoch 34/120
866/866 - 4s - 4ms/step - loss: 0.0240 - val_loss: 0.0918
Epoch 35/120
866/866 - 4s - 4ms/step - loss: 0.0240 - val_loss: 0.0919
Epoch 36/120
866/866 - 4s - 4ms/step - loss: 0.0241 - val_loss: 0.0923
Epoch 37/120
866/866 - 4s - 4ms/step - loss: 0.0237 - val_loss: 0.0918
Epoch 38/120
866/866 - 4s - 4ms/step - loss: 0.0235 - val_loss: 0.0907
Epoch 39/120
866/866 - 4s - 4ms/step - loss: 0.0236 - val_loss: 0.0915
Epoch 40/120
866/866 - 4s - 4ms/step - loss: 0.0234 - val_loss: 0.0928
Epoch 41/120
866/866 - 4s - 4ms/step - loss: 0.0231 - val_loss: 0.0913
Epoch 42/120
866/866 - 4s - 4ms/step - loss: 0.0231 - val_loss: 0.0915
Epoch 43/120
866/866 - 4s - 4ms/step - loss: 0.0227 - val_loss: 0.0908
Epoch 44/120
866/866 - 4s - 4ms/step - loss: 0.0226 - val_loss: 0.0904
Epoch 45/120
866/866 - 4s - 4ms/step - loss: 0.0226 - val_loss: 0.0914
Epoch 46/120
866/866 - 4s - 4ms/step - loss: 0.0224 - val_loss: 0.0895
Epoch 47/120
866/866 - 4s - 4ms/step - loss: 0.0222 - val_loss: 0.0921
Epoch 48/120
866/866 - 4s - 4ms/step - loss: 0.0221 - val_loss: 0.0924
Epoch 49/120
866/866 - 4s - 4ms/step - loss: 0.0220 - val_loss: 0.0904
Epoch 50/120
866/866 - 4s - 4ms/step - loss: 0.0219 - val_loss: 0.0898
Epoch 51/120
866/866 - 4s - 4ms/step - loss: 0.0218 - val_loss: 0.0938
Epoch 52/120
866/866 - 4s - 4ms/step - loss: 0.0217 - val_loss: 0.0896
Epoch 53/120
866/866 - 4s - 4ms/step - loss: 0.0218 - val_loss: 0.0900
Epoch 54/120
866/866 - 4s - 4ms/step - loss: 0.0214 - val_loss: 0.0869
Epoch 55/120
866/866 - 4s - 4ms/step - loss: 0.0214 - val_loss: 0.0869
Epoch 56/120
866/866 - 4s - 4ms/step - loss: 0.0213 - val_loss: 0.0891
Epoch 57/120
866/866 - 4s - 4ms/step - loss: 0.0213 - val_loss: 0.0915
Epoch 58/120
866/866 - 4s - 4ms/step - loss: 0.0213 - val_loss: 0.0905
Epoch 59/120
866/866 - 4s - 5ms/step - loss: 0.0211 - val_loss: 0.0906
Epoch 60/120
866/866 - 4s - 4ms/step - loss: 0.0211 - val_loss: 0.0925
Epoch 61/120
866/866 - 4s - 5ms/step - loss: 0.0212 - val_loss: 0.0868
Epoch 62/120
866/866 - 4s - 5ms/step - loss: 0.0208 - val_loss: 0.0897
Epoch 63/120
866/866 - 4s - 4ms/step - loss: 0.0207 - val_loss: 0.0898
Epoch 64/120
866/866 - 4s - 4ms/step - loss: 0.0207 - val_loss: 0.0887
Epoch 65/120
866/866 - 4s - 4ms/step - loss: 0.0207 - val_loss: 0.0884
Epoch 66/120
866/866 - 4s - 4ms/step - loss: 0.0207 - val_loss: 0.0896
Epoch 67/120
866/866 - 4s - 4ms/step - loss: 0.0206 - val_loss: 0.0883
Epoch 68/120
866/866 - 4s - 4ms/step - loss: 0.0205 - val_loss: 0.0900
Epoch 69/120
866/866 - 4s - 4ms/step - loss: 0.0204 - val_loss: 0.0873
Epoch 70/120
866/866 - 4s - 4ms/step - loss: 0.0203 - val_loss: 0.0892
Epoch 71/120
866/866 - 4s - 4ms/step - loss: 0.0205 - val_loss: 0.0901
Epoch 72/120
866/866 - 4s - 4ms/step - loss: 0.0202 - val_loss: 0.0902
Epoch 73/120
866/866 - 4s - 4ms/step - loss: 0.0204 - val_loss: 0.0916
Epoch 74/120
866/866 - 4s - 4ms/step - loss: 0.0200 - val_loss: 0.0894
Epoch 75/120
866/866 - 4s - 4ms/step - loss: 0.0200 - val_loss: 0.0883
Epoch 76/120
866/866 - 4s - 4ms/step - loss: 0.0200 - val_loss: 0.0890
Epoch 77/120
866/866 - 4s - 4ms/step - loss: 0.0200 - val_loss: 0.0893
Epoch 78/120
866/866 - 4s - 4ms/step - loss: 0.0198 - val_loss: 0.0891
Epoch 79/120
866/866 - 4s - 4ms/step - loss: 0.0198 - val_loss: 0.0893
Epoch 80/120
866/866 - 4s - 4ms/step - loss: 0.0197 - val_loss: 0.0872
Epoch 81/120
866/866 - 4s - 4ms/step - loss: 0.0200 - val_loss: 0.0893
Saved metrics JSON: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/metrics_train_test_H100.json

################################################
LSTM Residual Evaluation (test, unscaled units):
Total RMSE: 0.0996
Per-joint RMSE: 0.1311 0.1174 0.0927 0.0692 0.0958 0.0775
################################################

Saved predictions: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/predictions_test.npz
Saved best model:  /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_lstm.keras
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/loss_curve.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_gt_vs_pred.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_rmse_per_joint.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_rmse_time.png


##################################
### COMBINED EVAL seed=0 H=100 ###
##################################

==================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/combined_evaluation.py --residual_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --model /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_lstm.keras --scalers /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/scalers_H100.npz --out_dir /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2 --H 100 --split test --features state --save_pred_npz --metrics_csv /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv --metrics_json /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl --K 84 --test_fraction 0.2 --seed 0 --dataset_seed 1 --delan_seed 3 --delan_epochs 200 --hp_preset lutter_like_256_d3 --delan_rmse_val 0.3525549655191049 --delan_rmse_test 0.3336736226108652' ===
==================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:36:13.555800: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:36:13.582275: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/workspace/shared/.mplconfig is not a writable directory
Matplotlib created a temporary cache directory at /tmp/matplotlib-movy7ee2 because there was an issue with the default path (/workspace/shared/.mplconfig); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
Evaluate & Combine
 residual_npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
 model        = /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_lstm.keras
 split        = test
 H            = 100
 n_traj       = 17
 n_dof        = 6
 feature_dim  = 18
################################################
2026-01-29 18:36:14.610676: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:14.615871: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:14.616773: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:14.618594: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:14.619393: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:14.620138: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:14.695129: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:14.695973: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:14.696806: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:14.697715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8802 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
2026-01-29 18:36:15.006916: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
  done 17/17

################################################
Stage-2 Evaluation (test, valid k>=H-1):
DeLaN torque:   MSE=1.142538e-01  RMSE=3.380145e-01
  per-joint RMSE: 0.3930 0.4766 0.3243 0.2780 0.2532 0.2395
Residual LSTM:  MSE=9.924038e-03      RMSE=9.961947e-02
  per-joint RMSE: 0.1311 0.1174 0.0927 0.0692 0.0958 0.0775
Combined torque MSE=9.924038e-03     RMSE=9.961947e-02
  per-joint RMSE: 0.1311 0.1174 0.0927 0.0692 0.0958 0.0775
################################################

Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/metrics_test_H100.txt
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/metrics_test_H100.json
Appended CSV: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv
Appended JSON: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/combined_predictions_test_H100.npz
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/residual_gt_vs_pred_test_H100.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/torque_gt_vs_delan_vs_combined_test_H100.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/torque_rmse_per_joint_grouped_test_H100.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s0_H100_ep120_b64_u128_do0p2/torque_rmse_time_test_H100.png


###############################
### TRAIN LSTM seed=1 H=100 ###
###############################

==================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T lstm bash -lc 'python3 -c '"'"'import runpy
import keras.callbacks as cb
_Orig = cb.ModelCheckpoint

class PatchedModelCheckpoint(_Orig):
    def __init__(self, filepath, *args, **kwargs):
        if isinstance(filepath, str) and (not filepath.endswith('"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"')) and (not filepath.endswith('"'"'"'"'"'"'"'"'.h5'"'"'"'"'"'"'"'"')):
            filepath = filepath + '"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"'
        super().__init__(filepath, *args, **kwargs)

cb.ModelCheckpoint = PatchedModelCheckpoint
runpy.run_path('"'"'"'"'"'"'"'"'scripts/train_residual_lstm.py'"'"'"'"'"'"'"'"', run_name='"'"'"'"'"'"'"'"'__main__'"'"'"'"'"'"'"'"')
'"'"' --npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --out_dir /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2 --model_name residual_lstm.keras --epochs 120 --batch 64 --val_split 0.1 --seed 1 --units 128 --dropout 0.2 --eps 1e-08 --early_stop True --early_stop_patience 20 --early_stop_min_delta 0.0 --early_stop_warmup_evals 10 ' ===
==================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:36:17.340871: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:36:17.367306: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
mkdir -p failed for path /.config/matplotlib: [Errno 13] Permission denied: '/.config'
Matplotlib created a temporary cache directory at /tmp/matplotlib-pik3m2hc because there was an issue with the default path (/.config/matplotlib); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
LSTM Residual Dataset:
  npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__d1__lstm_windows_H100__feat_state__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
   H  = 100
  din = 18
 dout = 6
  X_train = (61557, 100, 18), Y_train = (61557, 6)
  X_test  = (13315, 100, 18),  Y_test  = (13315, 6)
################################################

Saved scalers: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/scalers_H100.npz
X mean/std shapes: (18,)/(18,)
Y mean/std shapes: (6,)/(6,)
2026-01-29 18:36:19.401999: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:19.407287: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:19.408199: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:19.409830: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:19.410730: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:19.411586: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:19.500739: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:19.501633: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:19.502514: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:36:19.503295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8800 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
/usr/local/lib/python3.11/dist-packages/keras/src/layers/rnn/rnn.py:205: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 100, 128)       │        75,264 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 100, 128)       │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 128)            │       131,584 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 128)            │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 6)              │           774 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 207,622 (811.02 KB)
 Trainable params: 207,622 (811.02 KB)
 Non-trainable params: 0 (0.00 B)


Epoch 1/120
2026-01-29 18:36:20.809353: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
866/866 - 5s - 6ms/step - loss: 0.0921 - val_loss: 0.1123
Epoch 2/120
866/866 - 4s - 4ms/step - loss: 0.0492 - val_loss: 0.1029
Epoch 3/120
866/866 - 4s - 4ms/step - loss: 0.0424 - val_loss: 0.1066
Epoch 4/120
866/866 - 4s - 4ms/step - loss: 0.0396 - val_loss: 0.1004
Epoch 5/120
866/866 - 4s - 4ms/step - loss: 0.0369 - val_loss: 0.0982
Epoch 6/120
866/866 - 4s - 4ms/step - loss: 0.0343 - val_loss: 0.0978
Epoch 7/120
866/866 - 4s - 4ms/step - loss: 0.0330 - val_loss: 0.0937
Epoch 8/120
866/866 - 4s - 4ms/step - loss: 0.0325 - val_loss: 0.0982
Epoch 9/120
866/866 - 4s - 4ms/step - loss: 0.0318 - val_loss: 0.0963
Epoch 10/120
866/866 - 4s - 4ms/step - loss: 0.0301 - val_loss: 0.0950
Epoch 11/120
866/866 - 4s - 4ms/step - loss: 0.0297 - val_loss: 0.0942
Epoch 12/120
866/866 - 4s - 4ms/step - loss: 0.0292 - val_loss: 0.0972
Epoch 13/120
866/866 - 4s - 4ms/step - loss: 0.0287 - val_loss: 0.0933
Epoch 14/120
866/866 - 4s - 4ms/step - loss: 0.0280 - val_loss: 0.0915
Epoch 15/120
866/866 - 4s - 4ms/step - loss: 0.0286 - val_loss: 0.0952
Epoch 16/120
866/866 - 4s - 4ms/step - loss: 0.0274 - val_loss: 0.0915
Epoch 17/120
866/866 - 4s - 4ms/step - loss: 0.0269 - val_loss: 0.0915
Epoch 18/120
866/866 - 4s - 4ms/step - loss: 0.0268 - val_loss: 0.0908
Epoch 19/120
866/866 - 4s - 4ms/step - loss: 0.0263 - val_loss: 0.0907
Epoch 20/120
866/866 - 4s - 4ms/step - loss: 0.0266 - val_loss: 0.0903
Epoch 21/120
866/866 - 4s - 4ms/step - loss: 0.0263 - val_loss: 0.0954
Epoch 22/120
866/866 - 4s - 4ms/step - loss: 0.0258 - val_loss: 0.0939
Epoch 23/120
866/866 - 4s - 4ms/step - loss: 0.0257 - val_loss: 0.0899
Epoch 24/120
866/866 - 4s - 4ms/step - loss: 0.0255 - val_loss: 0.0891
Epoch 25/120
866/866 - 4s - 4ms/step - loss: 0.0256 - val_loss: 0.0918
Epoch 26/120
866/866 - 4s - 4ms/step - loss: 0.0249 - val_loss: 0.0882
Epoch 27/120
866/866 - 4s - 4ms/step - loss: 0.0250 - val_loss: 0.0894
Epoch 28/120
866/866 - 4s - 4ms/step - loss: 0.0246 - val_loss: 0.0943
Epoch 29/120
866/866 - 4s - 4ms/step - loss: 0.0246 - val_loss: 0.0899
Epoch 30/120
866/866 - 4s - 4ms/step - loss: 0.0245 - val_loss: 0.0891
Epoch 31/120
866/866 - 4s - 4ms/step - loss: 0.0242 - val_loss: 0.0884
Epoch 32/120
866/866 - 4s - 4ms/step - loss: 0.0240 - val_loss: 0.0893
Epoch 33/120
866/866 - 4s - 4ms/step - loss: 0.0246 - val_loss: 0.0918
Epoch 34/120
866/866 - 4s - 4ms/step - loss: 0.0237 - val_loss: 0.0893
Epoch 35/120
866/866 - 4s - 4ms/step - loss: 0.0249 - val_loss: 0.0886
Epoch 36/120
866/866 - 4s - 4ms/step - loss: 0.0234 - val_loss: 0.0901
Epoch 37/120
866/866 - 4s - 4ms/step - loss: 0.0234 - val_loss: 0.0899
Epoch 38/120
866/866 - 4s - 4ms/step - loss: 0.0231 - val_loss: 0.0904
Epoch 39/120
866/866 - 4s - 4ms/step - loss: 0.0230 - val_loss: 0.0872
Epoch 40/120
866/866 - 4s - 4ms/step - loss: 0.0230 - val_loss: 0.0882
Epoch 41/120
866/866 - 4s - 4ms/step - loss: 0.0228 - val_loss: 0.0878
Epoch 42/120
866/866 - 4s - 4ms/step - loss: 0.0231 - val_loss: 0.0868
Epoch 43/120
866/866 - 4s - 4ms/step - loss: 0.0226 - val_loss: 0.0864
Epoch 44/120
866/866 - 4s - 4ms/step - loss: 0.0226 - val_loss: 0.0887
Epoch 45/120
866/866 - 4s - 4ms/step - loss: 0.0224 - val_loss: 0.0888
Epoch 46/120
866/866 - 4s - 4ms/step - loss: 0.0223 - val_loss: 0.0858
Epoch 47/120
866/866 - 4s - 4ms/step - loss: 0.0223 - val_loss: 0.0881
Epoch 48/120
866/866 - 4s - 4ms/step - loss: 0.0221 - val_loss: 0.0863
Epoch 49/120
866/866 - 4s - 4ms/step - loss: 0.0219 - val_loss: 0.0859
Epoch 50/120
866/866 - 4s - 4ms/step - loss: 0.0218 - val_loss: 0.0877
Epoch 51/120
866/866 - 4s - 4ms/step - loss: 0.0218 - val_loss: 0.0869
Epoch 52/120
866/866 - 4s - 4ms/step - loss: 0.0216 - val_loss: 0.0865
Epoch 53/120
866/866 - 4s - 4ms/step - loss: 0.0215 - val_loss: 0.0873
Epoch 54/120
866/866 - 4s - 4ms/step - loss: 0.0214 - val_loss: 0.0844
Epoch 55/120
866/866 - 4s - 4ms/step - loss: 0.0214 - val_loss: 0.0865
Epoch 56/120
866/866 - 4s - 4ms/step - loss: 0.0213 - val_loss: 0.0865
Epoch 57/120
866/866 - 4s - 4ms/step - loss: 0.0211 - val_loss: 0.0857
Epoch 58/120
866/866 - 4s - 4ms/step - loss: 0.0211 - val_loss: 0.0859
Epoch 59/120
866/866 - 4s - 4ms/step - loss: 0.0209 - val_loss: 0.0863
Epoch 60/120
866/866 - 4s - 4ms/step - loss: 0.0209 - val_loss: 0.0847
Epoch 61/120
866/866 - 4s - 4ms/step - loss: 0.0211 - val_loss: 0.0849
Epoch 62/120
866/866 - 4s - 4ms/step - loss: 0.0211 - val_loss: 0.0836
Epoch 63/120
866/866 - 4s - 4ms/step - loss: 0.0208 - val_loss: 0.0839
Epoch 64/120
866/866 - 4s - 4ms/step - loss: 0.0208 - val_loss: 0.0841
Epoch 65/120
866/866 - 4s - 4ms/step - loss: 0.0207 - val_loss: 0.0845
Epoch 66/120
866/866 - 4s - 4ms/step - loss: 0.0205 - val_loss: 0.0845
Epoch 67/120
866/866 - 4s - 4ms/step - loss: 0.0204 - val_loss: 0.0866
Epoch 68/120
866/866 - 4s - 4ms/step - loss: 0.0204 - val_loss: 0.0864
Epoch 69/120
866/866 - 4s - 4ms/step - loss: 0.0204 - val_loss: 0.0856
Epoch 70/120
866/866 - 4s - 4ms/step - loss: 0.0202 - val_loss: 0.0857
Epoch 71/120
866/866 - 4s - 4ms/step - loss: 0.0203 - val_loss: 0.0826
Epoch 72/120
866/866 - 4s - 4ms/step - loss: 0.0201 - val_loss: 0.0839
Epoch 73/120
866/866 - 4s - 4ms/step - loss: 0.0201 - val_loss: 0.0847
Epoch 74/120
866/866 - 4s - 4ms/step - loss: 0.0201 - val_loss: 0.0855
Epoch 75/120
866/866 - 4s - 4ms/step - loss: 0.0200 - val_loss: 0.0830
Epoch 76/120
866/866 - 4s - 4ms/step - loss: 0.0200 - val_loss: 0.0826
Epoch 77/120
866/866 - 4s - 4ms/step - loss: 0.0200 - val_loss: 0.0849
Epoch 78/120
866/866 - 4s - 4ms/step - loss: 0.0201 - val_loss: 0.0840
Epoch 79/120
866/866 - 4s - 4ms/step - loss: 0.0199 - val_loss: 0.0830
Epoch 80/120
866/866 - 4s - 4ms/step - loss: 0.0199 - val_loss: 0.0867
Epoch 81/120
866/866 - 4s - 4ms/step - loss: 0.0197 - val_loss: 0.0835
Epoch 82/120
866/866 - 4s - 4ms/step - loss: 0.0197 - val_loss: 0.0850
Epoch 83/120
866/866 - 4s - 4ms/step - loss: 0.0197 - val_loss: 0.0836
Epoch 84/120
866/866 - 4s - 4ms/step - loss: 0.0199 - val_loss: 0.0842
Epoch 85/120
866/866 - 4s - 4ms/step - loss: 0.0196 - val_loss: 0.0846
Epoch 86/120
866/866 - 4s - 4ms/step - loss: 0.0194 - val_loss: 0.0835
Epoch 87/120
866/866 - 4s - 4ms/step - loss: 0.0194 - val_loss: 0.0853
Epoch 88/120
866/866 - 4s - 5ms/step - loss: 0.0195 - val_loss: 0.0845
Epoch 89/120
866/866 - 4s - 4ms/step - loss: 0.0193 - val_loss: 0.0842
Epoch 90/120
866/866 - 4s - 4ms/step - loss: 0.0194 - val_loss: 0.0869
Epoch 91/120
866/866 - 4s - 4ms/step - loss: 0.0191 - val_loss: 0.0848
Saved metrics JSON: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/metrics_train_test_H100.json

################################################
LSTM Residual Evaluation (test, unscaled units):
Total RMSE: 0.0910
Per-joint RMSE: 0.1236 0.0912 0.0925 0.0684 0.0898 0.0693
################################################

Saved predictions: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/predictions_test.npz
Saved best model:  /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_lstm.keras
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/loss_curve.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_gt_vs_pred.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_rmse_per_joint.png
Saved: /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_rmse_time.png


##################################
### COMBINED EVAL seed=1 H=100 ###
##################################

==================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/combined_evaluation.py --residual_npz /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz --model /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_lstm.keras --scalers /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/scalers_H100.npz --out_dir /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2 --H 100 --split test --features state --save_pred_npz --metrics_csv /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv --metrics_json /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl --K 84 --test_fraction 0.2 --seed 1 --dataset_seed 1 --delan_seed 3 --delan_epochs 200 --hp_preset lutter_like_256_d3 --delan_rmse_val 0.3525549655191049 --delan_rmse_test 0.3336736226108652' ===
==================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-29 18:42:12.467678: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-29 18:42:12.493960: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/workspace/shared/.mplconfig is not a writable directory
Matplotlib created a temporary cache directory at /tmp/matplotlib-dord_nzq because there was an issue with the default path (/workspace/shared/.mplconfig); it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
################################################
Evaluate & Combine
 residual_npz = /workspace/shared/data/processed/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3/UR3_Load0_cc__delanModelStory__K84__residual__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3.npz
 model        = /workspace/shared/models/lstm/best/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_lstm.keras
 split        = test
 H            = 100
 n_traj       = 17
 n_dof        = 6
 feature_dim  = 18
################################################
2026-01-29 18:42:13.531285: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:42:13.536272: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:42:13.537151: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:42:13.538921: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:42:13.539738: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:42:13.540706: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:42:13.622771: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:42:13.623820: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:42:13.624707: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-29 18:42:13.625430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8780 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
2026-01-29 18:42:13.936560: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
  done 17/17

################################################
Stage-2 Evaluation (test, valid k>=H-1):
DeLaN torque:   MSE=1.142538e-01  RMSE=3.380145e-01
  per-joint RMSE: 0.3930 0.4766 0.3243 0.2780 0.2532 0.2395
Residual LSTM:  MSE=8.281807e-03      RMSE=9.100444e-02
  per-joint RMSE: 0.1236 0.0912 0.0925 0.0684 0.0898 0.0693
Combined torque MSE=8.281807e-03     RMSE=9.100444e-02
  per-joint RMSE: 0.1236 0.0912 0.0925 0.0684 0.0898 0.0693
################################################

Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/metrics_test_H100.txt
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/metrics_test_H100.json
Appended CSV: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.csv
Appended JSON: /workspace/shared/evaluation/summary_lstm_best_combined_20260129_184850.jsonl
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/combined_predictions_test_H100.npz
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/residual_gt_vs_pred_test_H100.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/torque_gt_vs_delan_vs_combined_test_H100.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/torque_rmse_per_joint_grouped_test_H100.png
Saved: /workspace/shared/evaluation/lstm_best/UR3_Load0_cc__delanModelStory__20260129_184850/UR3_Load0_cc__delanModelStory__K84__d1__delan_jax_struct_s3_ep200_hp_lutter_like_256_d3_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d3__feat_state__lstm_best_s1_H100_ep120_b64_u128_do0p2/torque_rmse_time_test_H100.png

