#######################################################################################################################
### RUN: K=150 test_fraction=0.2 seed=1                                                                             ###
### npz_in=/workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz ###
#######################################################################################################################

#####################
### 1) PREPROCESS ###
#####################

==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T preprocess bash -lc 'python3 scripts/build_delan_dataset.py --qdd True --col_format wide --trajectory_amount 150 --test_fraction 0.2 --val_fraction 0.1 --seed 1 --filter_accel True --filter_cutoff_hz 8.0 --filter_order 4 --filter_qdd True --raw_csv /workspace/shared/data/raw/delan_UR3_Load0_combined_26.csv --out_npz /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz' ===
==============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Saved: /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz
Trajectories: train=105 val=15 test=30
Exists: True

###################################################################################################################################################################################################################################################
### DELAN VARIANT: delan_seed=0                                                                                                                                                                                                                 ###
### ckpt=/workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax ###
###################################################################################################################################################################################################################################################

######################
### 2) DELAN TRAIN ###
######################

===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T delan_jax bash -lc 'python3 /workspace/delan_jax/scripts/rbyt_train_delan_jax.py --npz /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz -t structured -s 0 -r 0 --hp_preset lutter_like_256 --epochs 400 --save_path /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax' ===
===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Final hyper: {'dataset': 'delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2', 'n_width': 256, 'n_depth': 2, 'n_minibatch': 1024, 'diagonal_epsilon': 0.1, 'diagonal_shift': 2.0, 'activation': 'softplus', 'learning_rate': 0.0001, 'weight_decay': 1e-05, 'max_epoch': 400, 'lagrangian_type': <function structured_lagrangian_fn at 0x7033acc20280>}


################################################
DeLaN run: delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  model_dir = /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  ckpt_path = /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax
  type = structured
  hp_preset = lutter_like_256
################################################


################################################
Dataset: delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz
  npz = /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz
   dt ≈ 0.027122289385805493
  dof = 6
  Train trajectories = 105
  Val trajectories   = 15
  Test trajectories  = 30
  Train samples = 51043
  Test samples  = 13048
################################################

2026-01-24 01:36:24.426209: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.
2026-01-24 01:36:26.226248: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.
################################################
Training DeLaN | run=delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2 | type=structured | dof=6
################################################
Epoch 00001: Time=   3.9s, Loss=1.05e+04, Inv=1.05e+04, For=5.75e+00, Power=2.45e+03
  [eval] val_mse=1.875e+02  (n=7030)
Epoch 00050: Time=   7.4s, Loss=4.09e+00, Inv=4.09e+00, For=3.52e+01, Power=1.40e+00
Epoch 00100: Time=   9.4s, Loss=3.51e+00, Inv=3.51e+00, For=9.31e+01, Power=1.36e+00
Epoch 00150: Time=  11.4s, Loss=3.36e+00, Inv=3.36e+00, For=1.50e+02, Power=1.36e+00
Epoch 00200: Time=  13.4s, Loss=3.26e+00, Inv=3.26e+00, For=1.99e+02, Power=1.36e+00
  [eval] val_mse=4.521e-01  (n=7030)
Epoch 00250: Time=  15.5s, Loss=3.19e+00, Inv=3.19e+00, For=3.41e+02, Power=1.36e+00
Epoch 00300: Time=  17.5s, Loss=3.12e+00, Inv=3.12e+00, For=5.77e+02, Power=1.38e+00
Epoch 00350: Time=  19.5s, Loss=3.06e+00, Inv=3.06e+00, For=1.02e+03, Power=1.37e+00
Epoch 00400: Time=  21.5s, Loss=3.02e+00, Inv=3.02e+00, For=1.70e+03, Power=1.38e+00
  [eval] val_mse=4.896e-01  (n=7030)
Saved DeLaN checkpoint: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax
Saved training history: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__train_history.csv

################################################
Evaluating DeLaN | run=delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  [val] Torque RMSE = 2.857e-01
Torque MSE  = 1.216e-01
Torque RMSE = 3.486e-01
Per-joint MSE : 1.633e-01 3.082e-01 1.104e-01 6.034e-02 4.459e-02 4.261e-02
Per-joint RMSE: 4.040e-01 5.552e-01 3.322e-01 2.456e-01 2.112e-01 2.064e-01
Comp Time per Sample = 1.514e-04s / 6605.6Hz
Saved metrics TXT: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/metrics_test.txt
Saved metrics JSON: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s0_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/metrics.json

###################################################################################################################################################################################################################################################
### DELAN VARIANT: delan_seed=1                                                                                                                                                                                                                 ###
### ckpt=/workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax ###
###################################################################################################################################################################################################################################################

######################
### 2) DELAN TRAIN ###
######################

===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T delan_jax bash -lc 'python3 /workspace/delan_jax/scripts/rbyt_train_delan_jax.py --npz /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz -t structured -s 1 -r 0 --hp_preset lutter_like_256 --epochs 400 --save_path /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax' ===
===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Final hyper: {'dataset': 'delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2', 'n_width': 256, 'n_depth': 2, 'n_minibatch': 1024, 'diagonal_epsilon': 0.1, 'diagonal_shift': 2.0, 'activation': 'softplus', 'learning_rate': 0.0001, 'weight_decay': 1e-05, 'max_epoch': 400, 'lagrangian_type': <function structured_lagrangian_fn at 0x7256d9494280>}


################################################
DeLaN run: delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  model_dir = /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  ckpt_path = /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax
  type = structured
  hp_preset = lutter_like_256
################################################


################################################
Dataset: delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz
  npz = /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz
   dt ≈ 0.027122289385805493
  dof = 6
  Train trajectories = 105
  Val trajectories   = 15
  Test trajectories  = 30
  Train samples = 51043
  Test samples  = 13048
################################################

2026-01-24 01:36:55.558683: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.
2026-01-24 01:36:57.371240: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.
################################################
Training DeLaN | run=delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2 | type=structured | dof=6
################################################
Epoch 00001: Time=   3.8s, Loss=2.77e+03, Inv=2.77e+03, For=5.47e+00, Power=5.55e+02
  [eval] val_mse=7.343e+01  (n=7030)
Epoch 00050: Time=   7.3s, Loss=3.78e+00, Inv=3.78e+00, For=3.30e+01, Power=1.40e+00
Epoch 00100: Time=   9.3s, Loss=3.42e+00, Inv=3.42e+00, For=8.01e+01, Power=1.36e+00
Epoch 00150: Time=  11.4s, Loss=3.29e+00, Inv=3.29e+00, For=1.88e+02, Power=1.36e+00
Epoch 00200: Time=  13.4s, Loss=3.21e+00, Inv=3.21e+00, For=4.34e+02, Power=1.36e+00
  [eval] val_mse=4.530e-01  (n=7030)
Epoch 00250: Time=  15.4s, Loss=3.14e+00, Inv=3.14e+00, For=1.10e+03, Power=1.37e+00
Epoch 00300: Time=  17.4s, Loss=3.10e+00, Inv=3.10e+00, For=2.37e+03, Power=1.37e+00
Epoch 00350: Time=  19.4s, Loss=3.07e+00, Inv=3.07e+00, For=5.94e+03, Power=1.37e+00
Epoch 00400: Time=  21.4s, Loss=3.01e+00, Inv=3.01e+00, For=1.06e+04, Power=1.37e+00
  [eval] val_mse=4.997e-01  (n=7030)
Saved DeLaN checkpoint: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax
Saved training history: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__train_history.csv

################################################
Evaluating DeLaN | run=delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  [val] Torque RMSE = 2.886e-01
Torque MSE  = 1.215e-01
Torque RMSE = 3.486e-01
Per-joint MSE : 1.632e-01 3.158e-01 1.052e-01 6.147e-02 4.200e-02 4.142e-02
Per-joint RMSE: 4.040e-01 5.620e-01 3.244e-01 2.479e-01 2.049e-01 2.035e-01
Comp Time per Sample = 1.503e-04s / 6652.9Hz
Saved metrics TXT: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/metrics_test.txt
Saved metrics JSON: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s1_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/metrics.json

###################################################################################################################################################################################################################################################
### DELAN VARIANT: delan_seed=2                                                                                                                                                                                                                 ###
### ckpt=/workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax ###
###################################################################################################################################################################################################################################################

######################
### 2) DELAN TRAIN ###
######################

===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T delan_jax bash -lc 'python3 /workspace/delan_jax/scripts/rbyt_train_delan_jax.py --npz /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz -t structured -s 2 -r 0 --hp_preset lutter_like_256 --epochs 400 --save_path /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax' ===
===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Final hyper: {'dataset': 'delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2', 'n_width': 256, 'n_depth': 2, 'n_minibatch': 1024, 'diagonal_epsilon': 0.1, 'diagonal_shift': 2.0, 'activation': 'softplus', 'learning_rate': 0.0001, 'weight_decay': 1e-05, 'max_epoch': 400, 'lagrangian_type': <function structured_lagrangian_fn at 0x76de41894280>}


################################################
DeLaN run: delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  model_dir = /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  ckpt_path = /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax
  type = structured
  hp_preset = lutter_like_256
################################################


################################################
Dataset: delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz
  npz = /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz
   dt ≈ 0.027122289385805493
  dof = 6
  Train trajectories = 105
  Val trajectories   = 15
  Test trajectories  = 30
  Train samples = 51043
  Test samples  = 13048
################################################

2026-01-24 01:37:26.569615: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.
2026-01-24 01:37:28.364721: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.
################################################
Training DeLaN | run=delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2 | type=structured | dof=6
################################################
Epoch 00001: Time=   4.0s, Loss=6.13e+03, Inv=6.13e+03, For=5.47e+00, Power=5.75e+02
  [eval] val_mse=1.837e+02  (n=7030)
Epoch 00050: Time=   7.5s, Loss=3.99e+00, Inv=3.99e+00, For=3.85e+01, Power=1.40e+00
Epoch 00100: Time=   9.5s, Loss=3.54e+00, Inv=3.54e+00, For=8.72e+01, Power=1.37e+00
Epoch 00150: Time=  11.5s, Loss=3.37e+00, Inv=3.37e+00, For=1.64e+02, Power=1.36e+00
Epoch 00200: Time=  13.5s, Loss=3.27e+00, Inv=3.27e+00, For=2.48e+02, Power=1.36e+00
  [eval] val_mse=4.493e-01  (n=7030)
Epoch 00250: Time=  15.5s, Loss=3.20e+00, Inv=3.20e+00, For=3.16e+02, Power=1.37e+00
Epoch 00300: Time=  17.5s, Loss=3.14e+00, Inv=3.14e+00, For=6.40e+02, Power=1.37e+00
Epoch 00350: Time=  19.5s, Loss=3.07e+00, Inv=3.07e+00, For=1.17e+03, Power=1.37e+00
Epoch 00400: Time=  21.5s, Loss=3.04e+00, Inv=3.04e+00, For=1.97e+03, Power=1.37e+00
  [eval] val_mse=5.077e-01  (n=7030)
Saved DeLaN checkpoint: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax
Saved training history: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__train_history.csv

################################################
Evaluating DeLaN | run=delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  [val] Torque RMSE = 2.909e-01
Torque MSE  = 1.220e-01
Torque RMSE = 3.493e-01
Per-joint MSE : 1.626e-01 3.116e-01 1.099e-01 6.364e-02 4.275e-02 4.148e-02
Per-joint RMSE: 4.033e-01 5.582e-01 3.314e-01 2.523e-01 2.068e-01 2.037e-01
Comp Time per Sample = 1.552e-04s / 6442.7Hz
Saved metrics TXT: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/metrics_test.txt
Saved metrics JSON: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s2_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/metrics.json

###################################################################################################################################################################################################################################################
### DELAN VARIANT: delan_seed=3                                                                                                                                                                                                                 ###
### ckpt=/workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax ###
###################################################################################################################################################################################################################################################

######################
### 2) DELAN TRAIN ###
######################

===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T delan_jax bash -lc 'python3 /workspace/delan_jax/scripts/rbyt_train_delan_jax.py --npz /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz -t structured -s 3 -r 0 --hp_preset lutter_like_256 --epochs 400 --save_path /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax' ===
===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Final hyper: {'dataset': 'delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2', 'n_width': 256, 'n_depth': 2, 'n_minibatch': 1024, 'diagonal_epsilon': 0.1, 'diagonal_shift': 2.0, 'activation': 'softplus', 'learning_rate': 0.0001, 'weight_decay': 1e-05, 'max_epoch': 400, 'lagrangian_type': <function structured_lagrangian_fn at 0x78ab5cd74280>}


################################################
DeLaN run: delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  model_dir = /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  ckpt_path = /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax
  type = structured
  hp_preset = lutter_like_256
################################################


################################################
Dataset: delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz
  npz = /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz
   dt ≈ 0.027122289385805493
  dof = 6
  Train trajectories = 105
  Val trajectories   = 15
  Test trajectories  = 30
  Train samples = 51043
  Test samples  = 13048
################################################

2026-01-24 01:37:57.765720: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.
2026-01-24 01:37:59.568529: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.
################################################
Training DeLaN | run=delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2 | type=structured | dof=6
################################################
Epoch 00001: Time=   3.9s, Loss=6.51e+03, Inv=6.51e+03, For=5.56e+00, Power=9.18e+02
  [eval] val_mse=3.272e+02  (n=7030)
Epoch 00050: Time=   7.4s, Loss=4.07e+00, Inv=4.07e+00, For=2.16e+01, Power=1.44e+00
Epoch 00100: Time=   9.4s, Loss=3.51e+00, Inv=3.51e+00, For=3.80e+01, Power=1.37e+00
Epoch 00150: Time=  11.4s, Loss=3.34e+00, Inv=3.34e+00, For=7.54e+01, Power=1.36e+00
Epoch 00200: Time=  13.4s, Loss=3.26e+00, Inv=3.26e+00, For=1.37e+02, Power=1.36e+00
  [eval] val_mse=4.494e-01  (n=7030)
Epoch 00250: Time=  15.4s, Loss=3.19e+00, Inv=3.19e+00, For=2.53e+02, Power=1.37e+00
Epoch 00300: Time=  17.4s, Loss=3.12e+00, Inv=3.12e+00, For=4.89e+02, Power=1.37e+00
Epoch 00350: Time=  19.4s, Loss=3.07e+00, Inv=3.07e+00, For=7.72e+02, Power=1.37e+00
Epoch 00400: Time=  21.4s, Loss=3.02e+00, Inv=3.02e+00, For=9.86e+02, Power=1.37e+00
  [eval] val_mse=4.955e-01  (n=7030)
Saved DeLaN checkpoint: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax
Saved training history: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__train_history.csv

################################################
Evaluating DeLaN | run=delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  [val] Torque RMSE = 2.874e-01
Torque MSE  = 1.217e-01
Torque RMSE = 3.489e-01
Per-joint MSE : 1.676e-01 3.118e-01 1.047e-01 6.209e-02 4.089e-02 4.335e-02
Per-joint RMSE: 4.094e-01 5.584e-01 3.236e-01 2.492e-01 2.022e-01 2.082e-01
Comp Time per Sample = 1.573e-04s / 6358.4Hz
Saved metrics TXT: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/metrics_test.txt
Saved metrics JSON: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s3_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/metrics.json

###################################################################################################################################################################################################################################################
### DELAN VARIANT: delan_seed=4                                                                                                                                                                                                                 ###
### ckpt=/workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax ###
###################################################################################################################################################################################################################################################

######################
### 2) DELAN TRAIN ###
######################

===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T delan_jax bash -lc 'python3 /workspace/delan_jax/scripts/rbyt_train_delan_jax.py --npz /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz -t structured -s 4 -r 0 --hp_preset lutter_like_256 --epochs 400 --save_path /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax' ===
===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Final hyper: {'dataset': 'delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2', 'n_width': 256, 'n_depth': 2, 'n_minibatch': 1024, 'diagonal_epsilon': 0.1, 'diagonal_shift': 2.0, 'activation': 'softplus', 'learning_rate': 0.0001, 'weight_decay': 1e-05, 'max_epoch': 400, 'lagrangian_type': <function structured_lagrangian_fn at 0x7a0e58694280>}


################################################
DeLaN run: delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  model_dir = /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  ckpt_path = /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax
  type = structured
  hp_preset = lutter_like_256
################################################


################################################
Dataset: delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz
  npz = /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz
   dt ≈ 0.027122289385805493
  dof = 6
  Train trajectories = 105
  Val trajectories   = 15
  Test trajectories  = 30
  Train samples = 51043
  Test samples  = 13048
################################################

2026-01-24 01:38:28.930507: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.
2026-01-24 01:38:30.735020: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.
################################################
Training DeLaN | run=delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2 | type=structured | dof=6
################################################
Epoch 00001: Time=   3.9s, Loss=1.17e+04, Inv=1.17e+04, For=5.64e+00, Power=1.24e+03
  [eval] val_mse=1.325e+02  (n=7030)
Epoch 00050: Time=   7.4s, Loss=4.52e+00, Inv=4.52e+00, For=2.91e+01, Power=1.43e+00
Epoch 00100: Time=   9.4s, Loss=3.60e+00, Inv=3.60e+00, For=9.32e+01, Power=1.37e+00
Epoch 00150: Time=  11.4s, Loss=3.38e+00, Inv=3.38e+00, For=1.66e+02, Power=1.36e+00
Epoch 00200: Time=  13.5s, Loss=3.27e+00, Inv=3.27e+00, For=2.97e+02, Power=1.37e+00
  [eval] val_mse=4.389e-01  (n=7030)
Epoch 00250: Time=  15.5s, Loss=3.19e+00, Inv=3.19e+00, For=9.93e+02, Power=1.37e+00
Epoch 00300: Time=  17.5s, Loss=3.14e+00, Inv=3.14e+00, For=2.67e+03, Power=1.38e+00
Epoch 00350: Time=  19.5s, Loss=3.10e+00, Inv=3.10e+00, For=3.58e+03, Power=1.38e+00
Epoch 00400: Time=  21.6s, Loss=3.04e+00, Inv=3.04e+00, For=4.32e+03, Power=1.38e+00
  [eval] val_mse=4.820e-01  (n=7030)
Saved DeLaN checkpoint: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax
Saved training history: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__train_history.csv

################################################
Evaluating DeLaN | run=delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2
  [val] Torque RMSE = 2.834e-01
Torque MSE  = 1.191e-01
Torque RMSE = 3.451e-01
Per-joint MSE : 1.649e-01 2.955e-01 1.067e-01 6.379e-02 4.129e-02 4.250e-02
Per-joint RMSE: 4.061e-01 5.436e-01 3.267e-01 2.526e-01 2.032e-01 2.062e-01
Comp Time per Sample = 1.628e-04s / 6143.1Hz
Saved metrics TXT: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/metrics_test.txt
Saved metrics JSON: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/metrics.json


###############################################################################################################################################################################################################################
### 3) SELECT BEST DELAN (by val RMSE)                                                                                                                                                                                      ###
### best_seed=4 val_rmse=0.2834365934717051 test_rmse=0.34514453177291965                                                                                                                                                   ###
### metrics_json=/home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/metrics.json ###
###############################################################################################################################################################################################################################

#######################################
### 4) EXPORT RESIDUALS (best only) ###
#######################################

=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T delan_jax bash -lc 'python3 /workspace/delan_jax/scripts/export_delan_residuals_jax.py --npz_in /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz --ckpt /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax --out /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz' ===
=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Loading dataset: /workspace/shared/data/preprocessed/delan_delan_UR3_Load0_combined_26_K150_tf0p2_vf0p1_seed1_dataset.npz
Loading checkpoint: /workspace/shared/models/delan/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.jax
Detected n_dof=6 (seed=4)
2026-01-24 01:38:58.726627: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.

Exporting split=train: 105 trajectories
2026-01-24 01:39:00.166928: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.
2026-01-24 01:39:00.166940: W external/xla/xla/service/gpu/autotuning/dot_search_space.cc:200] All configs were filtered out because none of them sufficiently match the hints. Maybe the hints set does not contain a good representative set of valid configs?Working around this by using the full hints set instead.
  done 25/105
  done 50/105
  done 75/105
  done 100/105
  done 105/105

Exporting split=test: 30 trajectories
  done 25/30
  done 30/30

Saved residual trajectory dataset: /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz
Keys: ['test_labels', 'test_q', 'test_qd', 'test_qdd', 'test_r_tau', 'test_t', 'test_tau', 'test_tau_hat', 'train_labels', 'train_q', 'train_qd', 'train_qdd', 'train_r_tau', 'train_t', 'train_tau', 'train_tau_hat']
Saved export JSON: /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.json


##############################
### BLOCK: H=100 feat=full ###
##############################

#############################
### 5) BUILD LSTM WINDOWS ###
#############################

=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T preprocess bash -lc 'python3 scripts/build_lstm_windows.py --in_npz /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz --out_npz /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H100__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz --H 100 --features full' ===
=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Building LSTM windows
  in_npz      = /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz
  out_npz     = /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H100__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz
  H           = 100
  feature_mode= full
Saved: /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H100__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H100__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz
Saved: /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H100__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H100__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.json
H=100, n_dof=6, feature_dim=24
X_train: (45450, 100, 24)  Y_train: (45450, 6)
X_test : (11614, 100, 24)  Y_test : (11614, 6)
feature_mode=full


#####################
### 6) TRAIN LSTM ###
#####################

===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T lstm bash -lc 'python3 -c '"'"'import runpy
import keras.callbacks as cb
_Orig = cb.ModelCheckpoint

class PatchedModelCheckpoint(_Orig):
    def __init__(self, filepath, *args, **kwargs):
        if isinstance(filepath, str) and (not filepath.endswith('"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"')) and (not filepath.endswith('"'"'"'"'"'"'"'"'.h5'"'"'"'"'"'"'"'"')):
            filepath = filepath + '"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"'
        super().__init__(filepath, *args, **kwargs)

cb.ModelCheckpoint = PatchedModelCheckpoint
runpy.run_path('"'"'"'"'"'"'"'"'scripts/train_residual_lstm.py'"'"'"'"'"'"'"'"', run_name='"'"'"'"'"'"'"'"'__main__'"'"'"'"'"'"'"'"')
'"'"' --npz /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H100__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz --out_dir /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2 --model_name residual_lstm.keras --epochs 120 --batch 64 --val_split 0.1 --seed 1 --units 128 --dropout 0.2 --eps 1e-08 ' ===
===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-24 01:39:09.675537: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-24 01:39:09.699736: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
################################################
LSTM Residual Dataset:
  npz = /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H100__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H100__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz
   H  = 100
  din = 24
 dout = 6
  X_train = (45450, 100, 24), Y_train = (45450, 6)
  X_test  = (11614, 100, 24),  Y_test  = (11614, 6)
################################################

Saved scalers: /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/scalers_H100.npz
X mean/std shapes: (24,)/(24,)
Y mean/std shapes: (6,)/(6,)
2026-01-24 01:39:11.422435: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:39:11.427722: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:39:11.428702: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:39:11.430631: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:39:11.431585: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:39:11.432632: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:39:11.528642: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:39:11.529519: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:39:11.530409: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:39:11.531197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9304 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
/usr/local/lib/python3.11/dist-packages/keras/src/layers/rnn/rnn.py:205: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 100, 128)       │        78,336 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 100, 128)       │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 128)            │       131,584 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 128)            │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 6)              │           774 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 210,694 (823.02 KB)
 Trainable params: 210,694 (823.02 KB)
 Non-trainable params: 0 (0.00 B)


Epoch 1/120
2026-01-24 01:39:12.691183: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
640/640 - 4s - 7ms/step - loss: 0.1044 - val_loss: 0.2362
Epoch 2/120
640/640 - 3s - 5ms/step - loss: 0.0573 - val_loss: 0.2198
Epoch 3/120
640/640 - 3s - 4ms/step - loss: 0.0463 - val_loss: 0.2221
Epoch 4/120
640/640 - 3s - 4ms/step - loss: 0.0426 - val_loss: 0.2252
Epoch 5/120
640/640 - 3s - 5ms/step - loss: 0.0407 - val_loss: 0.2049
Epoch 6/120
640/640 - 3s - 4ms/step - loss: 0.0388 - val_loss: 0.1987
Epoch 7/120
640/640 - 3s - 5ms/step - loss: 0.0367 - val_loss: 0.1936
Epoch 8/120
640/640 - 3s - 4ms/step - loss: 0.0354 - val_loss: 0.2111
Epoch 9/120
640/640 - 3s - 5ms/step - loss: 0.0358 - val_loss: 0.2171
Epoch 10/120
640/640 - 3s - 4ms/step - loss: 0.0335 - val_loss: 0.1983
Epoch 11/120
640/640 - 3s - 4ms/step - loss: 0.0297 - val_loss: 0.2055
Epoch 12/120
640/640 - 3s - 4ms/step - loss: 0.0291 - val_loss: 0.1958
Epoch 13/120
640/640 - 3s - 4ms/step - loss: 0.0282 - val_loss: 0.2075
Epoch 14/120
640/640 - 3s - 4ms/step - loss: 0.0287 - val_loss: 0.2053
Epoch 15/120
640/640 - 3s - 4ms/step - loss: 0.0284 - val_loss: 0.2183
Epoch 16/120
640/640 - 3s - 4ms/step - loss: 0.0296 - val_loss: 0.2010
Epoch 17/120
640/640 - 3s - 4ms/step - loss: 0.0263 - val_loss: 0.1964
Saved metrics JSON: /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/metrics_train_test_H100.json

################################################
LSTM Residual Evaluation (test, unscaled units):
Total RMSE: 0.0714
Per-joint RMSE: 0.0807 0.0908 0.0855 0.0541 0.0531 0.0529
################################################

Saved predictions: /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/predictions_test.npz
Saved best model:  /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/residual_lstm.keras
Saved: /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/loss_curve.png
Saved: /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/residual_gt_vs_pred.png


##############################
### 7) COMBINED EVALUATION ###
##############################

========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/combined_evaluation.py --residual_npz /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz --model /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/residual_lstm.keras --scalers /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/scalers_H100.npz --out_dir /workspace/shared/evaluation/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2 --H 100 --split test --features full --save_pred_npz --metrics_csv /workspace/shared/evaluation/summary_metrics_sweep_1_20260124_014808.csv --metrics_json /workspace/shared/evaluation/summary_metrics_sweep_1_20260124_014808.jsonl --K 150 --test_fraction 0.2 --seed 1 --delan_seed 4 --delan_epochs 400 --hp_preset lutter_like_256 --delan_rmse_val 0.2834365934717051 --delan_rmse_test 0.34514453177291965' ===
========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-24 01:40:03.704069: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-24 01:40:03.728836: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
################################################
Evaluate & Combine
 residual_npz = /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz
 model        = /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/residual_lstm.keras
 split        = test
 H            = 100
 n_traj       = 30
 n_dof        = 6
 feature_dim  = 24
################################################
2026-01-24 01:40:04.593719: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:04.598696: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:04.599634: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:04.601686: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:04.602770: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:04.603780: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:04.689759: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:04.690651: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:04.691459: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:04.692252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9304 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
2026-01-24 01:40:04.994846: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
  done 25/30
  done 30/30

################################################
Stage-2 Evaluation (test, valid k>=H-1):
DeLaN torque:   MSE=1.182229e-01  RMSE=3.438356e-01
  per-joint RMSE: 0.4003 0.5456 0.3264 0.2479 0.2049 0.2037
Residual LSTM:  MSE=5.103620e-03      RMSE=7.143962e-02
  per-joint RMSE: 0.0807 0.0908 0.0855 0.0541 0.0531 0.0529
Combined torque MSE=5.103620e-03     RMSE=7.143962e-02
  per-joint RMSE: 0.0807 0.0908 0.0855 0.0541 0.0531 0.0529
################################################

Saved: /workspace/shared/evaluation/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/metrics_test_H100.txt
Saved: /workspace/shared/evaluation/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/metrics_test_H100.json
Appended CSV: /workspace/shared/evaluation/summary_metrics_sweep_1_20260124_014808.csv
Appended JSON: /workspace/shared/evaluation/summary_metrics_sweep_1_20260124_014808.jsonl
Saved: /workspace/shared/evaluation/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/combined_predictions_test_H100.npz
Saved: /workspace/shared/evaluation/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/residual_gt_vs_pred_test_H100.png
Saved: /workspace/shared/evaluation/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H100_ep120_b64_u128_do0p2/torque_gt_vs_delan_vs_combined_test_H100.png


##############################
### BLOCK: H=150 feat=full ###
##############################

#############################
### 5) BUILD LSTM WINDOWS ###
#############################

=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T preprocess bash -lc 'python3 scripts/build_lstm_windows.py --in_npz /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz --out_npz /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H150__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz --H 150 --features full' ===
=======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Building LSTM windows
  in_npz      = /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz
  out_npz     = /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H150__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz
  H           = 150
  feature_mode= full
Saved: /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H150__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H150__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz
Saved: /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H150__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H150__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.json
H=150, n_dof=6, feature_dim=24
X_train: (42700, 150, 24)  Y_train: (42700, 6)
X_test : (10914, 150, 24)  Y_test : (10914, 6)
feature_mode=full


#####################
### 6) TRAIN LSTM ###
#####################

===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T lstm bash -lc 'python3 -c '"'"'import runpy
import keras.callbacks as cb
_Orig = cb.ModelCheckpoint

class PatchedModelCheckpoint(_Orig):
    def __init__(self, filepath, *args, **kwargs):
        if isinstance(filepath, str) and (not filepath.endswith('"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"')) and (not filepath.endswith('"'"'"'"'"'"'"'"'.h5'"'"'"'"'"'"'"'"')):
            filepath = filepath + '"'"'"'"'"'"'"'"'.keras'"'"'"'"'"'"'"'"'
        super().__init__(filepath, *args, **kwargs)

cb.ModelCheckpoint = PatchedModelCheckpoint
runpy.run_path('"'"'"'"'"'"'"'"'scripts/train_residual_lstm.py'"'"'"'"'"'"'"'"', run_name='"'"'"'"'"'"'"'"'__main__'"'"'"'"'"'"'"'"')
'"'"' --npz /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H150__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz --out_dir /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2 --model_name residual_lstm.keras --epochs 120 --batch 64 --val_split 0.1 --seed 1 --units 128 --dropout 0.2 --eps 1e-08 ' ===
===========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-24 01:40:07.714591: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-24 01:40:07.739772: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
################################################
LSTM Residual Dataset:
  npz = /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H150__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__lstm_windows_H150__feat_full__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz
   H  = 150
  din = 24
 dout = 6
  X_train = (42700, 150, 24), Y_train = (42700, 6)
  X_test  = (10914, 150, 24),  Y_test  = (10914, 6)
################################################

Saved scalers: /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/scalers_H150.npz
X mean/std shapes: (24,)/(24,)
Y mean/std shapes: (6,)/(6,)
2026-01-24 01:40:09.784203: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:09.789389: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:09.790369: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:09.792370: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:09.793479: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:09.794392: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:09.887884: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:09.888942: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:09.889743: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:40:09.890520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9304 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
/usr/local/lib/python3.11/dist-packages/keras/src/layers/rnn/rnn.py:205: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 150, 128)       │        78,336 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 150, 128)       │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 128)            │       131,584 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 128)            │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 6)              │           774 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 210,694 (823.02 KB)
 Trainable params: 210,694 (823.02 KB)
 Non-trainable params: 0 (0.00 B)


Epoch 1/120
2026-01-24 01:40:11.250290: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
601/601 - 5s - 8ms/step - loss: 0.1045 - val_loss: 0.2574
Epoch 2/120
601/601 - 4s - 6ms/step - loss: 0.0532 - val_loss: 0.2424
Epoch 3/120
601/601 - 4s - 6ms/step - loss: 0.0451 - val_loss: 0.2184
Epoch 4/120
601/601 - 4s - 6ms/step - loss: 0.0410 - val_loss: 0.2061
Epoch 5/120
601/601 - 4s - 6ms/step - loss: 0.0387 - val_loss: 0.2104
Epoch 6/120
601/601 - 4s - 6ms/step - loss: 0.0372 - val_loss: 0.1959
Epoch 7/120
601/601 - 4s - 6ms/step - loss: 0.0349 - val_loss: 0.1917
Epoch 8/120
601/601 - 4s - 6ms/step - loss: 0.0344 - val_loss: 0.2044
Epoch 9/120
601/601 - 4s - 6ms/step - loss: 0.0316 - val_loss: 0.2080
Epoch 10/120
601/601 - 4s - 6ms/step - loss: 0.0313 - val_loss: 0.2137
Epoch 11/120
601/601 - 4s - 6ms/step - loss: 0.0298 - val_loss: 0.2161
Epoch 12/120
601/601 - 4s - 6ms/step - loss: 0.0289 - val_loss: 0.2126
Epoch 13/120
601/601 - 4s - 6ms/step - loss: 0.0276 - val_loss: 0.2004
Epoch 14/120
601/601 - 4s - 6ms/step - loss: 0.0276 - val_loss: 0.2088
Epoch 15/120
601/601 - 4s - 6ms/step - loss: 0.0269 - val_loss: 0.1994
Epoch 16/120
601/601 - 4s - 6ms/step - loss: 0.0266 - val_loss: 0.2100
Epoch 17/120
601/601 - 4s - 6ms/step - loss: 0.0263 - val_loss: 0.1952
Saved metrics JSON: /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/metrics_train_test_H150.json

################################################
LSTM Residual Evaluation (test, unscaled units):
Total RMSE: 0.0643
Per-joint RMSE: 0.0598 0.0793 0.0842 0.0501 0.0503 0.0530
################################################

Saved predictions: /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/predictions_test.npz
Saved best model:  /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/residual_lstm.keras
Saved: /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/loss_curve.png
Saved: /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/residual_gt_vs_pred.png


##############################
### 7) COMBINED EVALUATION ###
##############################

========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
=== docker compose -p payload_estimation --project-directory /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation --env-file /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/.env -f /home/robat/.localgit/algorithmic_payload_estimation/payload_estimation/docker-compose.yml exec -T evaluation bash -lc 'python3 scripts/combined_evaluation.py --residual_npz /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz --model /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/residual_lstm.keras --scalers /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/scalers_H150.npz --out_dir /workspace/shared/evaluation/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2 --H 150 --split test --features full --save_pred_npz --metrics_csv /workspace/shared/evaluation/summary_metrics_sweep_1_20260124_014808.csv --metrics_json /workspace/shared/evaluation/summary_metrics_sweep_1_20260124_014808.jsonl --K 150 --test_fraction 0.2 --seed 1 --delan_seed 4 --delan_epochs 400 --hp_preset lutter_like_256 --delan_rmse_val 0.2834365934717051 --delan_rmse_test 0.34514453177291965' ===
========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
2026-01-24 01:41:17.154957: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-24 01:41:17.180920: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
################################################
Evaluate & Combine
 residual_npz = /workspace/shared/data/processed/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__residual__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2.npz
 model        = /workspace/shared/models/lstm/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/residual_lstm.keras
 split        = test
 H            = 150
 n_traj       = 30
 n_dof        = 6
 feature_dim  = 24
################################################
2026-01-24 01:41:18.042735: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:41:18.047602: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:41:18.048442: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:41:18.050245: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:41:18.051085: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:41:18.051883: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:41:18.134019: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:41:18.134901: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:41:18.135687: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:998] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2026-01-24 01:41:18.136472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9304 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070 Ti, pci bus id: 0000:01:00.0, compute capability: 8.9
2026-01-24 01:41:18.437631: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:465] Loaded cuDNN version 8906
  done 25/30
  done 30/30

################################################
Stage-2 Evaluation (test, valid k>=H-1):
DeLaN torque:   MSE=1.172884e-01  RMSE=3.424739e-01
  per-joint RMSE: 0.3942 0.5462 0.3270 0.2461 0.2052 0.2009
Residual LSTM:  MSE=4.136206e-03      RMSE=6.431334e-02
  per-joint RMSE: 0.0598 0.0793 0.0842 0.0501 0.0503 0.0530
Combined torque MSE=4.136206e-03     RMSE=6.431334e-02
  per-joint RMSE: 0.0598 0.0793 0.0842 0.0501 0.0503 0.0530
################################################

Saved: /workspace/shared/evaluation/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/metrics_test_H150.txt
Saved: /workspace/shared/evaluation/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/metrics_test_H150.json
Appended CSV: /workspace/shared/evaluation/summary_metrics_sweep_1_20260124_014808.csv
Appended JSON: /workspace/shared/evaluation/summary_metrics_sweep_1_20260124_014808.jsonl
Saved: /workspace/shared/evaluation/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/combined_predictions_test_H150.npz
Saved: /workspace/shared/evaluation/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/residual_gt_vs_pred_test_H150.png
Saved: /workspace/shared/evaluation/delan_UR3_Load0_combined_26__A__K150_tf0p2_vf0p1__delan_jax_struct_s4_ep400_actsoftplus_b1024_lr1e-4_wd1e-5_w256_d2__feat_full__lstm_s1_H150_ep120_b64_u128_do0p2/torque_gt_vs_delan_vs_combined_test_H150.png

